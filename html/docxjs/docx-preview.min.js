((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jszip")):"function"==typeof define&&define.amd?define(["exports","jszip"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).docx={},e.JSZip)})(this,function(e,I){var a,u,t;(t=a=a||{}).OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",t.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",t.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",t.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",t.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",t.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",t.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",t.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",t.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",t.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",t.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",t.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",t.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",t.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",t.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",t.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties";let l={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",drawingml:"http://schemas.openxmlformats.org/drawingml/2006/main",picture:"http://schemas.openxmlformats.org/drawingml/2006/picture",compatibility:"http://schemas.openxmlformats.org/markup-compatibility/2006",math:"http://schemas.openxmlformats.org/officeDocument/2006/math"},p={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt"},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"},LineHeight:{mul:1/240,unit:""},VmlEmu:{mul:1/12700,unit:""}};function s(e,t=p.Dxa){return null==e||/.+(p[xt]|[%])$/.test(e)?e:""+(parseInt(e)*t.mul).toFixed(2)+t.unit}function i(e,t,r){if(e.namespaceURI==l.wordml){switch(e.localName){case"color":t.color=r.attr(e,"val");break;case"sz":t.fontSize=r.lengthAttr(e,"val",p.FontSize);break;default:return}return 1}}class r{elements(r,a=null){var s=[];for(let e=0,t=r.childNodes.length;e<t;e++){var n=r.childNodes.item(e);1!=n.nodeType||null!=a&&n.localName!=a||s.push(n)}return s}element(r,a){for(let e=0,t=r.childNodes.length;e<t;e++){var s=r.childNodes.item(e);if(1==s.nodeType&&s.localName==a)return s}return null}elementAttr(e,t,r){e=this.element(e,t);return e?this.attr(e,r):void 0}attrs(e){return Array.from(e.attributes)}attr(r,a){for(let e=0,t=r.attributes.length;e<t;e++){var s=r.attributes.item(e);if(s.localName==a)return s.value}return null}intAttr(e,t,r=null){e=this.attr(e,t);return e?parseInt(e):r}hexAttr(e,t,r=null){e=this.attr(e,t);return e?parseInt(e,16):r}floatAttr(e,t,r=null){e=this.attr(e,t);return e?parseFloat(e):r}boolAttr(e,t,r=null){var[e,a=!1]=[this.attr(e,t),r];switch(e){case"1":return!0;case"0":return!1;case"on":return!0;case"off":return!1;case"true":return!0;case"false":return!1;default:return a}}lengthAttr(e,t,r=p.Dxa){return s(this.attr(e,t),r)}}let m=new r;class n{constructor(e,t){this._package=e,this.path=t}async load(){this.rels=await this._package.loadRelationships(this.path);var e=await this._package.load(this.path),e=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=e),this.parseXml(e.firstElementChild)}save(){var e;this._package.update(this.path,(e=this._xmlDocument,(new XMLSerializer).serializeToString(e)))}parseXml(e){}}let O={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function H(e,s){return s.elements(e).map(e=>{var t,r=s,a={name:r.attr(e,"name"),embedFontRefs:[]};for(t of r.elements(e))switch(t.localName){case"family":a.family=r.attr(t,"val");break;case"altName":a.altName=r.attr(t,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":a.embedFontRefs.push(((e,t)=>({id:t.attr(e,"id"),key:t.attr(e,"fontKey"),type:O[e.localName]}))(t,r))}return a})}class _ extends n{parseXml(e){this.fonts=H(e,this._package.xmlParser)}}function o(e){var t=e.lastIndexOf("/")+1;return[0==t?"":e.substring(0,t),0==t?e:e.substring(t)]}function c(e,t){try{var r="http://docx/";return new URL(e,r+t).toString().substring(r.length)}catch{return""+t+e}}function h(e,r){return e.reduce((e,t)=>(e[r(t)]=t,e),{})}function d(e){return e&&"object"==typeof e&&!Array.isArray(e)}function g(e,...t){if(!t.length)return e;var r=t.shift();if(d(e)&&d(r))for(var a in r)d(r[a])?g(e[a]??(e[a]={}),r[a]):e[a]=r[a];return g(e,...t)}function b(e){return Array.isArray(e)?e:[e]}class f{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new r}get(e){return this._zip.files[(e=e).startsWith("/")?e.substr(1):e]}update(e,t){this._zip.file(e,t)}static async load(e,t){e=await I.loadAsync(e);return new f(e,t)}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){return this.get(e)?.async(t)??Promise.resolve(null)}async loadRelationships(e=null){let t="_rels/.rels";null!=e&&([e,r]=o(e),t=e+`_rels/${r}.rels`);var r,a,e=await this.load(t);return e?(r=this.parseXmlDocument(e).firstElementChild,(a=this.xmlParser).elements(r).map(e=>({id:a.attr(e,"Id"),type:a.attr(e,"Type"),target:a.attr(e,"Target"),targetMode:a.attr(e,"TargetMode")}))):null}parseXmlDocument(e){var[e,t=!1]=[e,this.options.trimXmlDeclaration];if(t&&(e=e.replace(/<[?].*[?]>/,"")),e=65279===(t=e).charCodeAt(0)?t.substring(1):t,t=(new DOMParser).parseFromString(e,"application/xml"),e=t.getElementsByTagName("parsererror")[0]?.textContent)throw new Error(e);return t}}class $ extends n{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}}function y(e,t){return{type:t.attr(e,"val"),color:t.attr(e,"color"),size:t.lengthAttr(e,"sz",p.Border),offset:t.lengthAttr(e,"space",p.Point),frame:t.boolAttr(e,"frame"),shadow:t.boolAttr(e,"shadow")}}function k(e,t=m){var r,a,s,n={};for(r of t.elements(e))switch(r.localName){case"pgSz":n.pageSize={width:t.lengthAttr(r,"w"),height:t.lengthAttr(r,"h"),orientation:t.attr(r,"orient")};break;case"type":n.type=t.attr(r,"val");break;case"pgMar":n.pageMargins={left:t.lengthAttr(r,"left"),right:t.lengthAttr(r,"right"),top:t.lengthAttr(r,"top"),bottom:t.lengthAttr(r,"bottom"),header:t.lengthAttr(r,"header"),footer:t.lengthAttr(r,"footer"),gutter:t.lengthAttr(r,"gutter")};break;case"cols":n.columns=((e,t)=>({numberOfColumns:t.intAttr(e,"num"),space:t.lengthAttr(e,"space"),separator:t.boolAttr(e,"sep"),equalWidth:t.boolAttr(e,"equalWidth",!0),columns:t.elements(e,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}))(r,t);break;case"headerReference":(n.headerRefs??(n.headerRefs=[])).push(v(r,t));break;case"footerReference":(n.footerRefs??(n.footerRefs=[])).push(v(r,t));break;case"titlePg":n.titlePage=t.boolAttr(r,"val",!0);break;case"pgBorders":n.pageBorders=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"left":a.left=y(r,t);break;case"top":a.top=y(r,t);break;case"right":a.right=y(r,t);break;case"bottom":a.bottom=y(r,t)}return a})(r,t);break;case"pgNumType":n.pageNumber=(a=r,{chapSep:(s=t).attr(a,"chapSep"),chapStyle:s.attr(a,"chapStyle"),format:s.attr(a,"fmt"),start:s.intAttr(a,"start")})}return n}function v(e,t){return{id:t.attr(e,"id"),type:t.attr(e,"type")}}function w(t,r){var a={};for(let e of r.elements(t))i(e,a,r);return a}function S(e,t){var r,a={};for(r of t.elements(e))P(r,a,t);return a}function P(e,t,r){if(e.namespaceURI==l.wordml){var a,s,n;if(!i(e,t,r))switch(e.localName){case"tabs":t.tabs=(n=r).elements(e,"tab").map(e=>({position:n.lengthAttr(e,"pos"),leader:n.attr(e,"leader"),style:n.attr(e,"val")}));break;case"sectPr":t.sectionProps=k(e,r);break;case"numPr":t.numbering=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"numId":a.id=t.attr(r,"val");break;case"ilvl":a.level=t.intAttr(r,"val")}return a})(e,r);break;case"spacing":return void(t.lineSpacing=(a=e,{before:(s=r).lengthAttr(a,"before"),after:s.lengthAttr(a,"after"),line:s.intAttr(a,"line"),lineRule:s.attr(a,"lineRule")}));case"textAlignment":return void(t.textAlignment=r.attr(e,"val"));case"keepLines":t.keepLines=r.boolAttr(e,"val",!0);break;case"keepNext":t.keepNext=r.boolAttr(e,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=r.boolAttr(e,"val",!0);break;case"outlineLvl":t.outlineLevel=r.intAttr(e,"val");break;case"pStyle":t.styleName=r.attr(e,"val");break;case"rPr":t.runProps=w(e,r);break;default:return}return 1}}function V(e,t){var r,a,s,n,l,i={numberings:[],abstractNumberings:[],bulletPictures:[]};for(r of t.elements(e))switch(r.localName){case"num":i.numberings.push(((e,t)=>{var r,a={id:t.attr(e,"numId"),overrides:[]};for(r of t.elements(e))switch(r.localName){case"abstractNumId":a.abstractId=t.attr(r,"val");break;case"lvlOverride":a.overrides.push(((e,t)=>{var r,a={level:t.intAttr(e,"ilvl")};for(r of t.elements(e))switch(r.localName){case"startOverride":a.start=t.intAttr(r,"val");break;case"lvl":a.numberingLevel=x(r,t)}return a})(r,t))}return a})(r,t));break;case"abstractNum":i.abstractNumberings.push(((e,t)=>{var r,a={id:t.attr(e,"abstractNumId"),levels:[]};for(r of t.elements(e))switch(r.localName){case"name":a.name=t.attr(r,"val");break;case"multiLevelType":a.multiLevelType=t.attr(r,"val");break;case"numStyleLink":a.numberingStyleLink=t.attr(r,"val");break;case"styleLink":a.styleLink=t.attr(r,"val");break;case"lvl":a.levels.push(x(r,t))}return a})(r,t));break;case"numPicBullet":i.bulletPictures.push((a=r,void 0,l=n=void 0,n=(n=(s=t).element(a,"pict"))&&s.element(n,"shape"),(l=n&&s.element(n,"imagedata"))?{id:s.attr(a,"numPicBulletId"),referenceId:s.attr(l,"id"),style:s.attr(n,"style")}:null))}return i}function x(e,t){var r,a={level:t.intAttr(e,"ilvl")};for(r of t.elements(e))switch(r.localName){case"start":a.start=t.attr(r,"val");break;case"lvlRestart":a.restart=t.intAttr(r,"val");break;case"numFmt":a.format=t.attr(r,"val");break;case"lvlText":a.text=t.attr(r,"val");break;case"lvlJc":a.justification=t.attr(r,"val");break;case"lvlPicBulletId":a.bulletPictureId=t.attr(r,"val");break;case"pStyle":a.paragraphStyle=t.attr(r,"val");break;case"pPr":a.paragraphProps=S(r,t);break;case"rPr":a.runProps=w(r,t)}return a}class z extends n{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){Object.assign(this,V(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}}class j extends n{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}}(t=u=u||{}).Document="document",t.Paragraph="paragraph",t.Run="run",t.Break="break",t.NoBreakHyphen="noBreakHyphen",t.Table="table",t.Row="row",t.Cell="cell",t.Hyperlink="hyperlink",t.Drawing="drawing",t.Image="image",t.Text="text",t.Tab="tab",t.Symbol="symbol",t.BookmarkStart="bookmarkStart",t.BookmarkEnd="bookmarkEnd",t.Footer="footer",t.Header="header",t.FootnoteReference="footnoteReference",t.EndnoteReference="endnoteReference",t.Footnote="footnote",t.Endnote="endnote",t.SimpleField="simpleField",t.ComplexField="complexField",t.Instruction="instruction",t.VmlPicture="vmlPicture",t.MmlMath="mmlMath",t.MmlMathParagraph="mmlMathParagraph",t.MmlFraction="mmlFraction",t.MmlFunction="mmlFunction",t.MmlFunctionName="mmlFunctionName",t.MmlNumerator="mmlNumerator",t.MmlDenominator="mmlDenominator",t.MmlRadical="mmlRadical",t.MmlBase="mmlBase",t.MmlDegree="mmlDegree",t.MmlSuperscript="mmlSuperscript",t.MmlSubscript="mmlSubscript",t.MmlPreSubSuper="mmlPreSubSuper",t.MmlSubArgument="mmlSubArgument",t.MmlSuperArgument="mmlSuperArgument",t.MmlNary="mmlNary",t.MmlDelimiter="mmlDelimiter",t.MmlRun="mmlRun",t.MmlEquationArray="mmlEquationArray",t.MmlLimit="mmlLimit",t.MmlLimitLower="mmlLimitLower",t.MmlMatrix="mmlMatrix",t.MmlMatrixRow="mmlMatrixRow",t.MmlBox="mmlBox",t.MmlBar="mmlBar",t.MmlGroupChar="mmlGroupChar",t.VmlElement="vmlElement",t.Inserted="inserted",t.Deleted="deleted",t.DeletedText="deletedText";class M{constructor(){this.children=[],this.cssStyle={}}}class W extends M{constructor(){super(...arguments),this.type=u.Header}}class X extends M{constructor(){super(...arguments),this.type=u.Footer}}class C extends n{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}}class U extends C{createRootElement(){return new W}}class q extends C{createRootElement(){return new X}}function N(e){if(void 0!==e)return parseInt(e)}class G extends n{parseXml(e){this.props=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"Template":a.template=r.textContent;break;case"Pages":a.pages=N(r.textContent);break;case"Words":a.words=N(r.textContent);break;case"Characters":a.characters=N(r.textContent);break;case"Application":a.application=r.textContent;break;case"Lines":a.lines=N(r.textContent);break;case"Paragraphs":a.paragraphs=N(r.textContent);break;case"Company":a.company=r.textContent;break;case"AppVersion":a.appVersion=r.textContent}return a})(e,this._package.xmlParser)}}class J extends n{parseXml(e){this.props=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"title":a.title=r.textContent;break;case"description":a.description=r.textContent;break;case"subject":a.subject=r.textContent;break;case"creator":a.creator=r.textContent;break;case"keywords":a.keywords=r.textContent;break;case"language":a.language=r.textContent;break;case"lastModifiedBy":a.lastModifiedBy=r.textContent;break;case"revision":r.textContent&&(a.revision=parseInt(r.textContent))}return a})(e,this._package.xmlParser)}}class Z{}function K(e,t){var r,a=new Z,e=t.element(e,"themeElements");for(r of t.elements(e))switch(r.localName){case"clrScheme":a.colorScheme=((e,t)=>{var r,a={name:t.attr(e,"name"),colors:{}};for(r of t.elements(e)){var s=t.element(r,"srgbClr"),n=t.element(r,"sysClr");s?a.colors[r.localName]=t.attr(s,"val"):n&&(a.colors[r.localName]=t.attr(n,"lastClr"))}return a})(r,t);break;case"fontScheme":a.fontScheme=((e,t)=>{var r,a={name:t.attr(e,"name")};for(r of t.elements(e))switch(r.localName){case"majorFont":a.majorFont=Y(r,t);break;case"minorFont":a.minorFont=Y(r,t)}return a})(r,t)}return a}function Y(e,t){return{latinTypeface:t.elementAttr(e,"latin","typeface"),eaTypeface:t.elementAttr(e,"ea","typeface"),csTypeface:t.elementAttr(e,"cs","typeface")}}class Q extends n{constructor(e,t){super(e,t)}parseXml(e){this.theme=K(e,this._package.xmlParser)}}class ee{}class te extends ee{constructor(){super(...arguments),this.type=u.Footnote}}class re extends ee{constructor(){super(...arguments),this.type=u.Endnote}}class ae extends n{constructor(e,t,r){super(e,t),this._documentParser=r}}class se extends ae{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",te)}}class ne extends ae{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",re)}}function le(e,t){var r,a={defaultNoteIds:[]};for(r of t.elements(e))switch(r.localName){case"numFmt":a.nummeringFormat=t.attr(r,"val");break;case"footnote":case"endnote":a.defaultNoteIds.push(t.attr(r,"id"))}return a}class ie extends n{constructor(e,t){super(e,t)}parseXml(e){this.settings=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"defaultTabStop":a.defaultTabStop=t.lengthAttr(r,"val");break;case"footnotePr":a.footnoteProps=le(r,t);break;case"endnotePr":a.endnoteProps=le(r,t);break;case"autoHyphenation":a.autoHyphenation=t.boolAttr(r,"val")}return a})(e,this._package.xmlParser)}}class oe extends n{parseXml(e){var r;this.props=(r=this._package.xmlParser).elements(e,"property").map(e=>{var t=e.firstChild;return{formatId:r.attr(e,"fmtid"),name:r.attr(e,"name"),type:t.nodeName,value:t.textContent}})}}let ce=[{type:a.OfficeDocument,target:"word/document.xml"},{type:a.ExtendedProperties,target:"docProps/app.xml"},{type:a.CoreProperties,target:"docProps/core.xml"},{type:a.CustomProperties,target:"docProps/custom.xml"}];class he{constructor(){this.parts=[],this.partsMap={}}static async load(e,t,r){var a=new he;return a._options=r,a._parser=t,a._package=await f.load(e,r),a.rels=await a._package.loadRelationships(),await Promise.all(ce.map(t=>{var e=a.rels.find(e=>e.type===t.type)??t;return a.loadRelationshipPart(e.target,e.type)})),a}save(e="blob"){return this._package.save(e)}async loadRelationshipPart(e,t){if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let r=null;switch(t){case a.OfficeDocument:this.documentPart=r=new $(this._package,e,this._parser);break;case a.FontTable:this.fontTablePart=r=new _(this._package,e);break;case a.Numbering:this.numberingPart=r=new z(this._package,e,this._parser);break;case a.Styles:this.stylesPart=r=new j(this._package,e,this._parser);break;case a.Theme:this.themePart=r=new Q(this._package,e);break;case a.Footnotes:this.footnotesPart=r=new se(this._package,e,this._parser);break;case a.Endnotes:this.endnotesPart=r=new ne(this._package,e,this._parser);break;case a.Footer:r=new q(this._package,e,this._parser);break;case a.Header:r=new U(this._package,e,this._parser);break;case a.CoreProperties:this.corePropsPart=r=new J(this._package,e);break;case a.ExtendedProperties:this.extendedPropsPart=r=new G(this._package,e);break;case a.CustomProperties:r=new oe(this._package,e);break;case a.Settings:this.settingsPart=r=new ie(this._package,e)}if(null==r)return Promise.resolve(null);if(this.partsMap[e]=r,this.parts.push(r),await r.load(),0<r.rels?.length){let[t]=o(r.path);await Promise.all(r.rels.map(e=>this.loadRelationshipPart(c(e.target,t),e.type)))}return r}async loadDocumentImage(e,t){t=await this.loadResource(t??this.documentPart,e,"blob");return this.blobToURL(t)}async loadNumberingImage(e){e=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(e)}async loadFont(e,t){e=await this.loadResource(this.fontTablePart,e,"uint8array");return e&&this.blobToURL(new Blob([((t,e)=>{var r=e.replace(/{|}|-/g,""),a=new Array(16);for(let e=0;e<16;e++)a[16-e-1]=parseInt(r.substr(2*e,2),16);for(let e=0;e<32;e++)t[e]=t[e]^a[e%16];return t})(e,t)]))}blobToURL(e){var a;return e?this._options.useBase64URL?(a=e,new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=()=>t(),r.readAsDataURL(a)})):URL.createObjectURL(e):null}findPartByRelId(t,e=null){var r=(e.rels??this.rels).find(e=>e.id==t),e=e?o(e.path)[0]:"";return r?this.partsMap[c(r.target,e)]:null}getPathById(e,t){var r=e.rels.find(e=>e.id==t),[e]=o(e.path);return r?c(r.target,e):null}loadResource(e,t,r){e=this.getPathById(e,t);return e?this._package.load(e,r):Promise.resolve(null)}}class pe extends M{constructor(){super(...arguments),this.type=u.VmlElement,this.attrs={}}}function ue(e,t){var r,a,s=new pe;switch(e.localName){case"rect":s.tagName="rect",Object.assign(s.attrs,{width:"100%",height:"100%"});break;case"oval":s.tagName="ellipse",Object.assign(s.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":s.tagName="line";break;case"shape":s.tagName="g";break;case"textbox":s.tagName="foreignObject",Object.assign(s.attrs,{width:"100%",height:"100%"});break;default:return null}for(r of m.attrs(e))switch(r.localName){case"style":s.cssStyleText=r.value;break;case"fillcolor":s.attrs.fill=r.value;break;case"from":var[n,l]=me(r.value);Object.assign(s.attrs,{x1:n,y1:l});break;case"to":var[n,l]=me(r.value);Object.assign(s.attrs,{x2:n,y2:l})}for(a of m.elements(e))switch(a.localName){case"stroke":Object.assign(s.attrs,(i=a,{stroke:m.attr(i,"color"),"stroke-width":m.lengthAttr(i,"weight",p.Emu)??"1px"}));break;case"fill":Object.assign(s.attrs,{});break;case"imagedata":s.tagName="image",Object.assign(s.attrs,{width:"100%",height:"100%"}),s.imageHref={id:m.attr(a,"id"),title:m.attr(a,"title")};break;case"txbxContent":s.children.push(...t.parseBodyElements(a));break;default:var i=ue(a,t);i&&s.children.push(i)}return s}function me(e){return e.split(",")}var de="inherit",ge="black",be="black",fe="transparent";let ye=[],ke={oMath:u.MmlMath,oMathPara:u.MmlMathParagraph,f:u.MmlFraction,func:u.MmlFunction,fName:u.MmlFunctionName,num:u.MmlNumerator,den:u.MmlDenominator,rad:u.MmlRadical,deg:u.MmlDegree,e:u.MmlBase,sSup:u.MmlSuperscript,sSub:u.MmlSubscript,sPre:u.MmlPreSubSuper,sup:u.MmlSuperArgument,sub:u.MmlSubArgument,d:u.MmlDelimiter,nary:u.MmlNary,eqArr:u.MmlEquationArray,lim:u.MmlLimit,limLow:u.MmlLimitLower,m:u.MmlMatrix,mr:u.MmlMatrixRow,box:u.MmlBox,bar:u.MmlBar,groupChr:u.MmlGroupChar};class ve{constructor(e){this.options={ignoreWidth:!1,debug:!1,...e}}parseNotes(e,t,r){var a,s=[];for(a of m.elements(e,t)){var n=new r;n.id=m.attr(a,"id"),n.noteType=m.attr(a,"type"),n.children=this.parseBodyElements(a),s.push(n)}return s}parseDocumentFile(e){var t=m.element(e,"body"),e=m.element(e,"background"),r=m.element(t,"sectPr");return{type:u.Document,children:this.parseBodyElements(t),props:r?k(r,m):{},cssStyle:e?this.parseBackground(e):{}}}parseBackground(e){var t={},e=A.colorAttr(e,"color");return e&&(t["background-color"]=e),t}parseBodyElements(e){var t,r=[];for(t of m.elements(e))switch(t.localName){case"p":r.push(this.parseParagraph(t));break;case"tbl":r.push(this.parseTable(t));break;case"sdt":r.push(...this.parseSdt(t,e=>this.parseBodyElements(e)))}return r}parseStylesFile(e){var t=[];return A.foreach(e,e=>{switch(e.localName){case"style":t.push(this.parseStyle(e));break;case"docDefaults":t.push(this.parseDefaultStyles(e))}}),t}parseDefaultStyles(e){var r={id:null,name:null,target:null,basedOn:null,styles:[]};return A.foreach(e,e=>{switch(e.localName){case"rPrDefault":var t=m.element(e,"rPr");t&&r.styles.push({target:"span",values:this.parseDefaultProperties(t,{})});break;case"pPrDefault":t=m.element(e,"pPr");t&&r.styles.push({target:"p",values:this.parseDefaultProperties(t,{})})}}),r}parseStyle(e){var r={id:m.attr(e,"styleId"),isDefault:m.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(m.attr(e,"type")){case"paragraph":r.target="p";break;case"table":r.target="table";break;case"character":r.target="span"}return A.foreach(e,e=>{switch(e.localName){case"basedOn":r.basedOn=m.attr(e,"val");break;case"name":r.name=m.attr(e,"val");break;case"link":r.linked=m.attr(e,"val");break;case"next":r.next=m.attr(e,"val");break;case"aliases":r.aliases=m.attr(e,"val").split(",");break;case"pPr":r.styles.push({target:"p",values:this.parseDefaultProperties(e,{})}),r.paragraphProps=S(e,m);break;case"rPr":r.styles.push({target:"span",values:this.parseDefaultProperties(e,{})}),r.runProps=w(e,m);break;case"tblPr":case"tcPr":r.styles.push({target:"td",values:this.parseDefaultProperties(e,{})});break;case"tblStylePr":for(var t of this.parseTableStyle(e))r.styles.push(t);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn("DOCX: Unknown style element: "+e.localName)}}),r}parseTableStyle(e){var t=[],r=m.attr(e,"type"),a="",s="";switch(r){case"firstRow":s=".first-row",a="tr.first-row td";break;case"lastRow":s=".last-row",a="tr.last-row td";break;case"firstCol":s=".first-col",a="td.first-col";break;case"lastCol":s=".last-col",a="td.last-col";break;case"band1Vert":s=":not(.no-vband)",a="td.odd-col";break;case"band2Vert":s=":not(.no-vband)",a="td.even-col";break;case"band1Horz":s=":not(.no-hband)",a="tr.odd-row";break;case"band2Horz":s=":not(.no-hband)",a="tr.even-row";break;default:return[]}return A.foreach(e,e=>{switch(e.localName){case"pPr":t.push({target:a+" p",mod:s,values:this.parseDefaultProperties(e,{})});break;case"rPr":t.push({target:a+" span",mod:s,values:this.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":t.push({target:a,mod:s,values:this.parseDefaultProperties(e,{})})}}),t}parseNumberingFile(e){var a=[],s={},n=[];return A.foreach(e,e=>{switch(e.localName){case"abstractNum":this.parseAbstractNumbering(e,n).forEach(e=>a.push(e));break;case"numPicBullet":n.push(this.parseNumberingPicBullet(e));break;case"num":var t=m.attr(e,"numId"),r=m.elementAttr(e,"abstractNumId","val");s[r]=t}}),a.forEach(e=>e.id=s[e.id]),a}parseNumberingPicBullet(e){var t=m.element(e,"pict"),t=t&&m.element(t,"shape"),r=t&&m.element(t,"imagedata");return r?{id:m.intAttr(e,"numPicBulletId"),src:m.attr(r,"id"),style:m.attr(t,"style")}:null}parseAbstractNumbering(e,t){var r=[],a=m.attr(e,"abstractNumId");return A.foreach(e,e=>{"lvl"===e.localName&&r.push(this.parseNumberingLevel(a,e,t))}),r}parseNumberingLevel(e,t,r){var a={id:e,level:m.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return A.foreach(t,e=>{switch(e.localName){case"start":a.start=m.intAttr(e,"val");break;case"pPr":this.parseDefaultProperties(e,a.pStyle);break;case"rPr":this.parseDefaultProperties(e,a.rStyle);break;case"lvlPicBulletId":var t=m.intAttr(e,"val");a.bullet=r.find(e=>e.id==t);break;case"lvlText":a.levelText=m.attr(e,"val");break;case"pStyle":a.pStyleName=m.attr(e,"val");break;case"numFmt":a.format=m.attr(e,"val");break;case"suff":a.suff=m.attr(e,"val")}}),a}parseSdt(e,t){e=m.element(e,"sdtContent");return e?t(e):[]}parseInserted(e,t){return{type:u.Inserted,children:t(e)?.children??[]}}parseDeleted(e,t){return{type:u.Deleted,children:t(e)?.children??[]}}parseParagraph(e){var t,r,a,s={type:u.Paragraph,children:[]};for(t of m.elements(e))switch(t.localName){case"pPr":this.parseParagraphProperties(t,s);break;case"r":s.children.push(this.parseRun(t,s));break;case"hyperlink":s.children.push(this.parseHyperlink(t,s));break;case"bookmarkStart":s.children.push((r=t,a=m,{type:u.BookmarkStart,id:a.attr(r,"id"),name:a.attr(r,"name"),colFirst:a.intAttr(r,"colFirst"),colLast:a.intAttr(r,"colLast")}));break;case"bookmarkEnd":s.children.push((a=t,r=m,{type:u.BookmarkEnd,id:r.attr(a,"id")}));break;case"oMath":case"oMathPara":s.children.push(this.parseMathElement(t));break;case"sdt":s.children.push(...this.parseSdt(t,e=>this.parseParagraph(e).children));break;case"ins":s.children.push(this.parseInserted(t,e=>this.parseParagraph(e)));break;case"del":s.children.push(this.parseDeleted(t,e=>this.parseParagraph(e)))}return s}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{if(!P(e,t,m))switch(e.localName){case"pStyle":t.styleName=m.attr(e,"val");break;case"cnfStyle":t.className=T.classNameOfCnfStyle(e);break;case"framePr":this.parseFrame(e,t);break;case"rPr":break;default:return!1}return!0})}parseFrame(e,t){"drop"==m.attr(e,"dropCap")&&(t.cssStyle.float="left")}parseHyperlink(e,t){var r={type:u.Hyperlink,parent:t,children:[]},t=m.attr(e,"anchor"),a=m.attr(e,"id");return t&&(r.href="#"+t),a&&(r.id=a),A.foreach(e,e=>{"r"===e.localName&&r.children.push(this.parseRun(e,r))}),r}parseRun(e,t){var r={type:u.Run,parent:t,children:[]};return A.foreach(e,e=>{switch((e=this.checkAlternateContent(e)).localName){case"t":r.children.push({type:u.Text,text:e.textContent});break;case"delText":r.children.push({type:u.DeletedText,text:e.textContent});break;case"fldSimple":r.children.push({type:u.SimpleField,instruction:m.attr(e,"instr"),lock:m.boolAttr(e,"lock",!1),dirty:m.boolAttr(e,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:u.Instruction,text:e.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:u.ComplexField,charType:m.attr(e,"fldCharType"),lock:m.boolAttr(e,"lock",!1),dirty:m.boolAttr(e,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:u.NoBreakHyphen});break;case"br":r.children.push({type:u.Break,break:m.attr(e,"type")||"textWrapping"});break;case"lastRenderedPageBreak":r.children.push({type:u.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:u.Symbol,font:m.attr(e,"font"),char:m.attr(e,"char")});break;case"tab":r.children.push({type:u.Tab});break;case"footnoteReference":r.children.push({type:u.FootnoteReference,id:m.attr(e,"id")});break;case"endnoteReference":r.children.push({type:u.EndnoteReference,id:m.attr(e,"id")});break;case"drawing":var t=this.parseDrawing(e);t&&(r.children=[t]);break;case"pict":r.children.push(this.parseVmlPicture(e));break;case"rPr":this.parseRunProperties(e,r)}}),r}parseMathElement(e){var t,r,a=e.localName+"Pr",s={type:ke[e.localName],children:[]};for(t of m.elements(e))ke[t.localName]?s.children.push(this.parseMathElement(t)):"r"==t.localName?((r=this.parseRun(t)).type=u.MmlRun,s.children.push(r)):t.localName==a&&(s.props=this.parseMathProperies(t));return s}parseMathProperies(e){var t,r={};for(t of m.elements(e))switch(t.localName){case"chr":r.char=m.attr(t,"val");break;case"vertJc":r.verticalJustification=m.attr(t,"val");break;case"pos":r.position=m.attr(t,"val");break;case"degHide":r.hideDegree=m.boolAttr(t,"val");break;case"begChr":r.beginChar=m.attr(t,"val");break;case"endChr":r.endChar=m.attr(t,"val")}return r}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{switch(e.localName){case"rStyle":t.styleName=m.attr(e,"val");break;case"vertAlign":t.verticalAlign=T.valueOfVertAlign(e,!0);break;default:return!1}return!0})}parseVmlPicture(e){var t,r={type:u.VmlPicture,children:[]};for(t of m.elements(e)){var a=ue(t,this);a&&r.children.push(a)}return r}checkAlternateContent(e){if("AlternateContent"!=e.localName)return e;var t=m.element(e,"Choice");if(t){var r=m.attr(t,"Requires"),r=e.lookupNamespaceURI(r);if(ye.includes(r))return t.firstElementChild}return m.element(e,"Fallback")?.firstElementChild}parseDrawing(e){for(var t of m.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){let t={type:u.Drawing,children:[],cssStyle:{}},r="anchor"==e.localName,a=null;var s,n,l,i=m.boolAttr(e,"simplePos"),o={relative:"page",align:"left",offset:"0"},c={relative:"page",align:"top",offset:"0"};for(s of m.elements(e))switch(s.localName){case"simplePos":i&&(o.offset=m.lengthAttr(s,"x",p.Emu),c.offset=m.lengthAttr(s,"y",p.Emu));break;case"extent":t.cssStyle.width=m.lengthAttr(s,"cx",p.Emu),t.cssStyle.height=m.lengthAttr(s,"cy",p.Emu);break;case"positionH":case"positionV":i||(n="positionH"==s.localName?o:c,h=m.element(s,"align"),l=m.element(s,"posOffset"),n.relative=m.attr(s,"relativeFrom")??n.relative,h&&(n.align=h.textContent),l&&(n.offset=A.sizeValue(l,p.Emu)));break;case"wrapTopAndBottom":a="wrapTopAndBottom";break;case"wrapNone":a="wrapNone";break;case"graphic":var h=this.parseGraphic(s);h&&t.children.push(h)}return"wrapTopAndBottom"==a?(t.cssStyle.display="block",o.align&&(t.cssStyle["text-align"]=o.align,t.cssStyle.width="100%")):"wrapNone"==a?(t.cssStyle.display="block",t.cssStyle.position="relative",t.cssStyle.width="0px",t.cssStyle.height="0px",o.offset&&(t.cssStyle.left=o.offset),c.offset&&(t.cssStyle.top=c.offset)):!r||"left"!=o.align&&"right"!=o.align||(t.cssStyle.float=o.align),t}parseGraphic(e){var t,e=m.element(e,"graphicData");for(t of m.elements(e))if("pic"===t.localName)return this.parsePicture(t);return null}parsePicture(e){var t,r={type:u.Image,src:"",cssStyle:{}},a=m.element(e,"blipFill"),a=m.element(a,"blip"),a=(r.src=m.attr(a,"embed"),m.element(e,"spPr")),e=m.element(a,"xfrm");r.cssStyle.position="relative";for(t of m.elements(e))switch(t.localName){case"ext":r.cssStyle.width=m.lengthAttr(t,"cx",p.Emu),r.cssStyle.height=m.lengthAttr(t,"cy",p.Emu);break;case"off":r.cssStyle.left=m.lengthAttr(t,"x",p.Emu),r.cssStyle.top=m.lengthAttr(t,"y",p.Emu)}return r}parseTable(e){var t={type:u.Table,children:[]};return A.foreach(e,e=>{switch(e.localName){case"tr":t.children.push(this.parseTableRow(e));break;case"tblGrid":t.columns=this.parseTableColumns(e);break;case"tblPr":this.parseTableProperties(e,t)}}),t}parseTableColumns(e){var t=[];return A.foreach(e,e=>{"gridCol"===e.localName&&t.push({width:m.lengthAttr(e,"w")})}),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,e=>{switch(e.localName){case"tblStyle":t.styleName=m.attr(e,"val");break;case"tblLook":t.className=T.classNameOftblLook(e);break;case"tblpPr":this.parseTablePosition(e,t);break;case"tblStyleColBandSize":t.colBandSize=m.intAttr(e,"val");break;case"tblStyleRowBandSize":t.rowBandSize=m.intAttr(e,"val");break;default:return!1}return!0}),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto"}}parseTablePosition(e,t){var r=m.lengthAttr(e,"topFromText"),a=m.lengthAttr(e,"bottomFromText"),s=m.lengthAttr(e,"rightFromText"),e=m.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=T.addSize(t.cssStyle["margin-bottom"],a),t.cssStyle["margin-left"]=T.addSize(t.cssStyle["margin-left"],e),t.cssStyle["margin-right"]=T.addSize(t.cssStyle["margin-right"],s),t.cssStyle["margin-top"]=T.addSize(t.cssStyle["margin-top"],r)}parseTableRow(e){var t={type:u.Row,children:[]};return A.foreach(e,e=>{switch(e.localName){case"tc":t.children.push(this.parseTableCell(e));break;case"trPr":this.parseTableRowProperties(e,t)}}),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"cnfStyle":t.className=T.classNameOfCnfStyle(e);break;case"tblHeader":t.isHeader=m.boolAttr(e,"val");break;default:return!1}return!0})}parseTableCell(e){var t={type:u.Cell,children:[]};return A.foreach(e,e=>{switch(e.localName){case"tbl":t.children.push(this.parseTable(e));break;case"p":t.children.push(this.parseParagraph(e));break;case"tcPr":this.parseTableCellProperties(e,t)}}),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"gridSpan":t.span=m.intAttr(e,"val",null);break;case"vMerge":t.verticalMerge=m.attr(e,"val")??"continue";break;case"cnfStyle":t.className=T.classNameOfCnfStyle(e);break;default:return!1}return!0})}parseDefaultProperties(t,r=null,a=null,s=null){return r=r||{},A.foreach(t,e=>{if(!s?.(e))switch(e.localName){case"jc":r["text-align"]=T.valueOfJc(e);break;case"textAlignment":r["vertical-align"]=T.valueOfTextAlignment(e);break;case"color":r.color=A.colorAttr(e,"val",null,ge);break;case"sz":r["font-size"]=r["min-height"]=m.lengthAttr(e,"val",p.FontSize);break;case"shd":r["background-color"]=A.colorAttr(e,"fill",null,de);break;case"highlight":r["background-color"]=A.colorAttr(e,"val",null,fe);break;case"vertAlign":break;case"position":r.verticalAlign=m.lengthAttr(e,"val",p.FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":r.width=T.valueOfSize(e,"w");break;case"trHeight":this.parseTrHeight(e,r);break;case"strike":r["text-decoration"]=m.boolAttr(e,"val",!0)?"line-through":"none";break;case"b":r["font-weight"]=m.boolAttr(e,"val",!0)?"bold":"normal";break;case"i":r["font-style"]=m.boolAttr(e,"val",!0)?"italic":"normal";break;case"caps":r["text-transform"]=m.boolAttr(e,"val",!0)?"uppercase":"none";break;case"smallCaps":r["font-variant"]=m.boolAttr(e,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(e,r);break;case"ind":case"tblInd":this.parseIndentation(e,r);break;case"rFonts":this.parseFont(e,r);break;case"tblBorders":this.parseBorderProperties(e,a||r);break;case"tblCellSpacing":r["border-spacing"]=T.valueOfMargin(e),r["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(e,r);break;case"bdr":r.border=T.valueOfBorder(e);break;case"tcBorders":this.parseBorderProperties(e,r);break;case"vanish":m.boolAttr(e,"val",!0)&&(r.display="none");break;case"kern":case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(e,a||r);break;case"tblLayout":r["table-layout"]=T.valueOfTblLayout(e);break;case"vAlign":r["vertical-align"]=T.valueOfTextAlignment(e);break;case"spacing":"pPr"==t.localName&&this.parseSpacing(e,r);break;case"wordWrap":m.boolAttr(e,"val")&&(r["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":r.hyphens=m.boolAttr(e,"val",!0)?"none":"auto";break;case"lang":r.$lang=m.attr(e,"val");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${t.localName}.`+e.localName)}}),r}parseUnderline(e,t){var r=m.attr(e,"val");if(null!=r){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"words":t["text-decoration"]="underline";break;case"none":t["text-decoration"]="none"}r=A.colorAttr(e,"color");r&&(t["text-decoration-color"]=r)}}parseFont(e,t){e=[m.attr(e,"ascii"),T.themeValue(e,"asciiTheme")].filter(e=>e).join(", ");0<e.length&&(t["font-family"]=e)}parseIndentation(e,t){var r=m.lengthAttr(e,"firstLine"),a=m.lengthAttr(e,"hanging"),s=m.lengthAttr(e,"left"),n=m.lengthAttr(e,"start"),l=m.lengthAttr(e,"right"),e=m.lengthAttr(e,"end");r&&(t["text-indent"]=r),a&&(t["text-indent"]="-"+a),(s||n)&&(t["margin-left"]=s||n),(l||e)&&(t["margin-right"]=l||e)}parseSpacing(e,t){var r=m.lengthAttr(e,"before"),a=m.lengthAttr(e,"after"),s=m.intAttr(e,"line",null),e=m.attr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),null!==s)switch(e){case"auto":t["line-height"]=""+(s/240).toFixed(2);break;case"atLeast":t["line-height"]=`calc(100% + ${s/20}pt)`;break;default:t["line-height"]=t["min-height"]=s/20+"pt"}}parseMarginProperties(e,t){A.foreach(e,e=>{switch(e.localName){case"left":t["padding-left"]=T.valueOfMargin(e);break;case"right":t["padding-right"]=T.valueOfMargin(e);break;case"top":t["padding-top"]=T.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=T.valueOfMargin(e)}})}parseTrHeight(e,t){m.attr(e,"hRule"),t.height=m.lengthAttr(e,"val")}parseBorderProperties(e,t){A.foreach(e,e=>{switch(e.localName){case"start":case"left":t["border-left"]=T.valueOfBorder(e);break;case"end":case"right":t["border-right"]=T.valueOfBorder(e);break;case"top":t["border-top"]=T.valueOfBorder(e);break;case"bottom":t["border-bottom"]=T.valueOfBorder(e)}})}}let we=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class A{static foreach(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];a.nodeType==Node.ELEMENT_NODE&&t(a)}}static colorAttr(e,t,r=null,a="black"){t=m.attr(e,t);return t?"auto"==t?a:we.includes(t)?t:"#"+t:(a=m.attr(e,"themeColor"))?`var(--docx-${a}-color)`:r}static sizeValue(e,t=p.Dxa){return s(e.textContent,t)}}class T{static themeValue(e,t){e=m.attr(e,t);return e?`var(--docx-${e}-font)`:null}static valueOfSize(e,t){var r=p.Dxa;switch(m.attr(e,"type")){case"dxa":break;case"pct":r=p.Percent;break;case"auto":return"auto"}return m.lengthAttr(e,t,r)}static valueOfMargin(e){return m.lengthAttr(e,"w")}static valueOfBorder(e){var t;return"nil"==m.attr(e,"val")?"none":(t=A.colorAttr(e,"color"),m.lengthAttr(e,"sz",p.Border)+" solid "+("auto"==t?be:t))}static valueOfTblLayout(e){return"fixed"==m.attr(e,"val")?"fixed":"auto"}static classNameOfCnfStyle(e){let r=m.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((e,t)=>"1"==r[t]).join(" ")}static valueOfJc(e){e=m.attr(e,"val");switch(e){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return e}static valueOfVertAlign(e,t=!1){e=m.attr(e,"val");switch(e){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:e}static valueOfTextAlignment(e){e=m.attr(e,"val");switch(e){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return e}static addSize(e,t){return null==e?t:null==t?e:`calc(${e} + ${t})`}static classNameOftblLook(e){var t=m.hexAttr(e,"val",0);let r="";return(m.boolAttr(e,"firstRow")||32&t)&&(r+=" first-row"),(m.boolAttr(e,"lastRow")||64&t)&&(r+=" last-row"),(m.boolAttr(e,"firstColumn")||128&t)&&(r+=" first-col"),(m.boolAttr(e,"lastColumn")||256&t)&&(r+=" last-col"),(m.boolAttr(e,"noHBand")||512&t)&&(r+=" no-hband"),(m.boolAttr(e,"noVBand")||1024&t)&&(r+=" no-vband"),r.trim()}}let Se={pos:0,leader:"none",style:"left"};function Pe(e){return parseFloat(e)}let E={svg:"http://www.w3.org/2000/svg",mathML:"http://www.w3.org/1998/Math/MathML"};class xe{constructor(e){this.htmlDocument=e,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHeaderFooterParts=[],this.currentTabs=[],this.tabsTimeout=0,this.tasks=[],this.createElement=D}render(e,t,r=null,a){this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],Ce(r=r||t),Ce(t),L(r,"docxjs library predefined styles"),r.appendChild(this.renderDefaultStyle()),e.themePart&&(L(r,"docxjs document theme values"),this.renderTheme(e.themePart,r)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),L(r,"docxjs document styles"),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.prodessNumberings(e.numberingPart.domNumberings),L(r,"docxjs document numbering styles"),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),e.footnotesPart&&(this.footnoteMap=h(e.footnotesPart.notes,e=>e.id)),e.endnotesPart&&(this.endnoteMap=h(e.endnotesPart.notes,e=>e.id)),e.settingsPart&&(this.defaultTabSize=e.settingsPart.settings?.defaultTabStop),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r);a=t;this.options.inWrapper&&(a=this.renderWrapper(),t.appendChild(a)),this.renderSections(e.documentPart.body,a),this.refreshTabStops()}renderTheme(e,t){var r={},a=e.theme?.fontScheme,a=(a&&(a.majorFont&&(r["--docx-majorHAnsi-font"]=a.majorFont.latinTypeface),a.minorFont)&&(r["--docx-minorHAnsi-font"]=a.minorFont.latinTypeface),e.theme?.colorScheme);if(a)for(var[s,n]of Object.entries(a.colors))r[`--docx-${s}-color`]="#"+n;e=this.styleToString("."+this.className,r);t.appendChild(B(e))}renderFontTable(e,a){for(let r of e.fonts)for(let t of r.embedFontRefs)this.tasks.push(this.document.loadFont(t.id,t.key).then(e=>{e={"font-family":r.name,src:`url(${e})`},"bold"!=t.type&&"boldItalic"!=t.type||(e["font-weight"]="bold"),"italic"!=t.type&&"boldItalic"!=t.type||(e["font-style"]="italic"),L(a,`docxjs ${r.name} font`),e=this.styleToString("@font-face",e);a.appendChild(B(e)),this.refreshTabStops()}))}processStyleName(e){return e?this.className+"_"+e?.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase():this.className}processStyles(e){var r,t,a=h(e.filter(e=>null!=e.id),e=>e.id);for(r of e.filter(e=>e.basedOn)){var s=a[r.basedOn];if(s){r.paragraphProps=g(r.paragraphProps,s.paragraphProps),r.runProps=g(r.runProps,s.runProps);for(let t of s.styles){var n=r.styles.find(e=>e.target==t.target);n?this.copyStyleProperties(t.values,n.values):r.styles.push({...t,values:{...t.values}})}}else this.options.debug&&console.warn("Can't find base style "+r.basedOn)}for(t of e)t.cssName=this.processStyleName(t.id);return a}prodessNumberings(e){for(var t of e.filter(e=>e.pStyleName)){var r=this.findStyle(t.pStyleName);r?.paragraphProps?.numbering&&(r.paragraphProps.numbering.level=t.level)}}processElement(e){if(e.children)for(var t of e.children)t.parent=e,t.type==u.Table?this.processTable(t):this.processElement(t)}processTable(e){for(var t of e.children)for(var r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}copyStyleProperties(e,t,r=null){if(e){null==t&&(t={});for(var a of r=null==r?Object.getOwnPropertyNames(e):r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a])}return t}createSection(e,t){e=this.createElement("section",{className:e});return t&&(t.pageMargins&&(e.style.paddingLeft=t.pageMargins.left,e.style.paddingRight=t.pageMargins.right,e.style.paddingTop=t.pageMargins.top,e.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(e.style.width=t.pageSize.width),this.options.ignoreHeight||(e.style.minHeight=t.pageSize.height)),t.columns)&&t.columns.numberOfColumns&&(e.style.columnCount=""+t.columns.numberOfColumns,e.style.columnGap=t.columns.space,t.columns.separator)&&(e.style.columnRule="1px solid black"),e}renderSections(r,a){this.processElement(r);var s=this.splitBySection(r.children);let n=null;for(let e=0,t=s.length;e<t;e++){this.currentFootnoteIds=[];var l=s[e],i=l.sectProps||r.props,o=this.createSection(this.className,i),c=(a.appendChild(o),this.renderStyleValues(r.cssStyle,o),this.options.renderHeaders&&this.renderHeaderFooter(i.headerRefs,i,e,n!=i,o),this.createElement("article"));o.appendChild(c),this.renderElements(l.elements,c),this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,o),this.options.renderEndnotes&&e==t-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,o),this.options.renderFooters&&this.renderHeaderFooter(i.footerRefs,i,e,n!=i,o),n=i}}renderHeaderFooter(e,t,r,a,s){e&&(r=(a=(t.titlePage&&a?e.find(e=>"first"==e.type):null)??(r%2==1?e.find(e=>"even"==e.type):null)??e.find(e=>"default"==e.type))&&this.document.findPartByRelId(a.id,this.document.documentPart))&&(this.currentPart=r,this.usedHeaderFooterParts.includes(r.path)||(this.processElement(r.rootElement),this.usedHeaderFooterParts.push(r.path)),[e]=this.renderElements([r.rootElement],s),t?.pageMargins&&(r.rootElement.type===u.Header?(e.style.marginTop=`calc(${t.pageMargins.header} - ${t.pageMargins.top})`,e.style.minHeight=`calc(${t.pageMargins.top} - ${t.pageMargins.header})`):r.rootElement.type===u.Footer&&(e.style.marginBottom=`calc(${t.pageMargins.footer} - ${t.pageMargins.bottom})`,e.style.minHeight=`calc(${t.pageMargins.bottom} - ${t.pageMargins.footer})`)),this.currentPart=null)}isPageBreakElement(e){return e.type==u.Break&&("lastRenderedPageBreak"==e.break?this.options.useLastRenderedPageBreak:"page"==e.break)}splitBySection(e){var t,r,a,s,n,l,i,o,c={sectProps:null,elements:[]},h=[c];for(t of e)t.type==u.Paragraph&&this.findStyle(t.styleName)?.paragraphProps?.pageBreakBefore&&(c.sectProps=r,h.push(c={sectProps:null,elements:[]})),c.elements.push(t),t.type==u.Paragraph&&(r=(i=t).sectionProps,a=o=-1,this.options.breakPages&&i.children&&(o=i.children.findIndex(e=>-1!=(a=e.children?.findIndex(this.isPageBreakElement.bind(this))??-1))),!r&&-1==o||(c.sectProps=r,h.push(c={sectProps:null,elements:[]})),-1!=o)&&(s=i.children[o],n=a<s.children.length-1,o<i.children.length-1||n)&&(i=t.children,l={...t,children:i.slice(o)},t.children=i.slice(0,o),c.elements.push(l),n)&&(i=s.children,o={...s,children:i.slice(0,a)},t.children.push(o),s.children=i.slice(a));let p=null;for(let e=h.length-1;0<=e;e--)null==h[e].sectProps?h[e].sectProps=p:p=h[e].sectProps;return h}renderWrapper(e){return this.createElement("div",{className:this.className+"-wrapper"},e)}renderDefaultStyle(){var e=this.className;return B(`
.${e}-wrapper {
	background: gray;
	counter-reset: ${e}-page 0;
	display: flex;
	padding: 30px;
	column-gap: 30px;
	row-gap: 30px;
	flex-flow: column;
	align-items: center;
}
.${e}-side2side .${e}-wrapper {
	flex-flow: row;
	flex-wrap: wrap;
	align-items: start;
	justify-content: center;
}
.${e}-wrapper > section.${e} {
	background: white;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
}
.${e}-pagering .${e}-wrapper > section.${e}:before {
	background: white;
	color: gray;
	counter-increment: ${e}-page 1;
	content: counter(docx-page) " ";
	font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
	font-size: 12px;
	height: 16px;
	line-height: 16px;
	padding: 0 5px;
	text-align: center;
	position: absolute;
	left: 0;
	top: -16px;
}
.${e} {
	color: black;
	hyphens: auto;
	text-underline-position: from-font;
}
section.${e} {
	box-sizing: border-box;
	display: flex;
	flex-flow: column nowrap;
	position: relative;
}
section.${e} > article {
	margin-bottom: auto;
	z-index: 1;
}
section.${e} > footer {
	z-index: 1;
}
.${e} table {
	border-collapse: collapse;
}
.${e} table td, .${e} table th {
	vertical-align: top;
}
.${e} p {
	margin: 0pt;
	min-height: 1em;
}
.${e} span {
	white-space: pre-wrap;
	overflow-wrap: break-word;
}
.${e} a {
	color: inherit;
	text-decoration: inherit;
}`)}renderNumbering(e,r){var a,s="",t=[this.className+"-page"];for(a of e){var n,l,i="p."+this.numberingClass(a.id,a.level),o="none";if(a.bullet){let t=(`--${this.className}-`+a.bullet.src).toLowerCase();s+=this.styleToString(i+":before",{content:"' '",display:"inline-block",background:`var(${t})`},a.bullet.style),this.tasks.push(this.document.loadNumberingImage(a.bullet.src).then(e=>{e=`${this.rootSelector} { ${t}: url(${e}) }`;r.appendChild(B(e))}))}else a.levelText?(l=(n=this.numberingCounter(a.id,a.level))+" "+(a.start-1),0<a.level&&(s+=this.styleToString("p."+this.numberingClass(a.id,a.level-1),{"counter-reset":l})),t.push(l),s+=this.styleToString(i+":before",{content:this.levelTextToContent(a.levelText,a.suff,a.id,this.numFormatToCssValue(a.format)),"counter-increment":n,...a.rStyle})):o=this.numFormatToCssValue(a.format);s+=this.styleToString(i,{display:"list-item","list-style-position":"inside","list-style-type":o,...a.pStyle})}return 0<t.length&&(s+=this.styleToString(this.rootSelector,{"counter-reset":t.join(" ")})),B(s)}renderStyles(e){var t,r="",a=this.styleMap,s=h(e.filter(e=>e.isDefault),e=>e.target);for(t of e){var n,l,i=t.styles;t.linked&&((n=t.linked&&a[t.linked])?i=i.concat(n.styles):this.options.debug&&console.warn("Can't find linked style "+t.linked));for(l of i){var o=`${t.target??""}.`+t.cssName;t.target!=l.target&&(o+=" "+l.target),s[t.target]==t&&(o=`.${this.className} ${t.target}, `+o),r+=this.styleToString(o,l.values)}}return B(r)}renderNotes(e,t,r){var e=e.map(e=>t[e]).filter(e=>e);0<e.length&&(e=this.createElement("ol",null,this.renderElements(e)),r.appendChild(e))}renderElement(e){switch(e.type){case u.Paragraph:return this.renderParagraph(e);case u.BookmarkStart:return this.renderBookmarkStart(e);case u.BookmarkEnd:return null;case u.Run:return this.renderRun(e);case u.Table:return this.renderTable(e);case u.Row:return this.renderTableRow(e);case u.Cell:return this.renderTableCell(e);case u.Hyperlink:return this.renderHyperlink(e);case u.Drawing:return this.renderDrawing(e);case u.Image:return this.renderImage(e);case u.Text:case u.Text:return this.renderText(e);case u.DeletedText:return this.renderDeletedText(e);case u.Tab:return this.renderTab(e);case u.Symbol:return this.renderSymbol(e);case u.Break:return this.renderBreak(e);case u.Footer:return this.renderContainer(e,"footer");case u.Header:return this.renderContainer(e,"header");case u.Footnote:case u.Endnote:return this.renderContainer(e,"li");case u.FootnoteReference:return this.renderFootnoteReference(e);case u.EndnoteReference:return this.renderEndnoteReference(e);case u.NoBreakHyphen:return this.createElement("wbr");case u.VmlPicture:return this.renderVmlPicture(e);case u.VmlElement:return this.renderVmlElement(e);case u.MmlMath:return this.renderContainerNS(e,E.mathML,"math",{xmlns:E.mathML});case u.MmlMathParagraph:return this.renderContainer(e,"span");case u.MmlFraction:return this.renderContainerNS(e,E.mathML,"mfrac");case u.MmlBase:return this.renderContainerNS(e,E.mathML,e.parent.type==u.MmlMatrixRow?"mtd":"mrow");case u.MmlNumerator:case u.MmlDenominator:case u.MmlFunction:case u.MmlLimit:case u.MmlBox:return this.renderContainerNS(e,E.mathML,"mrow");case u.MmlGroupChar:return this.renderMmlGroupChar(e);case u.MmlLimitLower:return this.renderContainerNS(e,E.mathML,"munder");case u.MmlMatrix:return this.renderContainerNS(e,E.mathML,"mtable");case u.MmlMatrixRow:return this.renderContainerNS(e,E.mathML,"mtr");case u.MmlRadical:return this.renderMmlRadical(e);case u.MmlSuperscript:return this.renderContainerNS(e,E.mathML,"msup");case u.MmlSubscript:return this.renderContainerNS(e,E.mathML,"msub");case u.MmlDegree:case u.MmlSuperArgument:case u.MmlSubArgument:return this.renderContainerNS(e,E.mathML,"mn");case u.MmlFunctionName:return this.renderContainerNS(e,E.mathML,"ms");case u.MmlDelimiter:return this.renderMmlDelimiter(e);case u.MmlRun:return this.renderMmlRun(e);case u.MmlNary:return this.renderMmlNary(e);case u.MmlPreSubSuper:return this.renderMmlPreSubSuper(e);case u.MmlBar:return this.renderMmlBar(e);case u.MmlEquationArray:return this.renderMllList(e);case u.Inserted:return this.renderInserted(e);case u.Deleted:return this.renderDeleted(e)}return null}renderChildren(e,t){return this.renderElements(e.children,t)}renderElements(e,t){return null==e?null:(e=e.flatMap(e=>this.renderElement(e)).filter(e=>null!=e),t&&Ne(t,e),e)}renderContainer(e,t,r){return this.createElement(t,r,this.renderChildren(e))}renderContainerNS(e,t,r,a){return R(t,r,a,this.renderChildren(e))}renderParagraph(e){var t=this.createElement("p"),r=this.findStyle(e.styleName),e=(e.tabs??(e.tabs=r?.paragraphProps?.tabs),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.renderCommonProperties(t.style,e),e.numbering??r?.paragraphProps?.numbering);return e&&t.classList.add(this.numberingClass(e.id,e.level)),t}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize)&&(e["font-size"]=t.fontSize)}renderHyperlink(t){var e,r=this.createElement("a");return this.renderChildren(t,r),this.renderStyleValues(t.cssStyle,r),t.href?r.href=t.href:t.id&&(e=this.document.documentPart.rels.find(e=>e.id==t.id&&"External"===e.targetMode),r.href=e?.target),r}renderDrawing(e){var t=this.createElement("div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=this.createElement("img");return this.renderStyleValues(e.cssStyle,t),this.document&&this.tasks.push(this.document.loadDocumentImage(e.src,this.currentPart).then(e=>{t.src=e})),t}renderText(e){return this.htmlDocument.createTextNode(e.text)}renderDeletedText(e){return this.options.renderEndnotes?this.htmlDocument.createTextNode(e.text):null}renderBreak(e){return"textWrapping"==e.break?this.createElement("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderChildren(e)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){var t=this.createElement("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderFootnoteReference(e){var t=this.createElement("sup");return this.currentFootnoteIds.push(e.id),t.textContent=""+this.currentFootnoteIds.length,t}renderEndnoteReference(e){var t=this.createElement("sup");return this.currentEndnoteIds.push(e.id),t.textContent=""+this.currentEndnoteIds.length,t}renderTab(e){var t=this.createElement("span");return t.innerHTML="&emsp;",this.options.experimental&&(t.className=this.tabStopClass(),e=((e,t)=>{for(var r=e.parent;null!=r&&r.type!=t;)r=r.parent;return r})(e,u.Paragraph)?.tabs,this.currentTabs.push({stops:e,span:t})),t}renderBookmarkStart(e){var t=this.createElement("span");return t.id=e.name,t}renderRun(e){var t,r;return e.fieldRun?null:(t=this.createElement("span"),e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign?(r=this.createElement(e.verticalAlign),this.renderChildren(e,r),t.appendChild(r)):this.renderChildren(e,t),t)}renderTable(e){var t=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){var t,r=this.createElement("colgroup");for(t of e){var a=this.createElement("col");t.width&&(a.style.width=t.width),r.appendChild(a)}return r}renderTableRow(e){var t=this.createElement("tr");return this.currentCellPosition.col=0,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentCellPosition.row++,t}renderTableCell(e){var t=this.createElement("td"),r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t).rowSpan=1:this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){var t=D("div");return this.renderChildren(e,t),t}renderVmlElement(e){var t=Me("svg");t.setAttribute("style",e.cssStyleText);let r=this.renderVmlChildElement(e);return e.imageHref?.id&&this.tasks.push(this.document?.loadDocumentImage(e.imageHref.id,this.currentPart).then(e=>r.setAttribute("href",e))),t.appendChild(r),requestAnimationFrame(()=>{var e=t.firstElementChild.getBBox();t.setAttribute("width",""+Math.ceil(e.x+e.width)),t.setAttribute("height",""+Math.ceil(e.y+e.height))}),t}renderVmlChildElement(e){let r=Me(e.tagName);Object.entries(e.attrs).forEach(([e,t])=>r.setAttribute(e,t));for(var t of e.children)t.type==u.VmlElement?r.appendChild(this.renderVmlChildElement(t)):r.appendChild(...b(this.renderElement(t)));return r}renderMmlRadical(e){var t=e.children.find(e=>e.type==u.MmlBase);return e.props?.hideDegree?R(E.mathML,"msqrt",null,this.renderElements([t])):(e=e.children.find(e=>e.type==u.MmlDegree),R(E.mathML,"mroot",null,this.renderElements([t,e])))}renderMmlDelimiter(e){var t=[];return t.push(R(E.mathML,"mo",null,[e.props.beginChar??"("])),t.push(...this.renderElements(e.children)),t.push(R(E.mathML,"mo",null,[e.props.endChar??")"])),R(E.mathML,"mrow",null,t)}renderMmlNary(e){var t=[],r=h(e.children,e=>e.type),a=r[u.MmlSuperArgument],s=r[u.MmlSubArgument],a=a?R(E.mathML,"mo",null,b(this.renderElement(a))):null,s=s?R(E.mathML,"mo",null,b(this.renderElement(s))):null,e=R(E.mathML,"mo",null,[e.props?.char??""]);return t.push(a||s?R(E.mathML,"munderover",null,[e,s,a]):a?R(E.mathML,"mover",null,[e,a]):s?R(E.mathML,"munder",null,[e,s]):e),t.push(...this.renderElements(r[u.MmlBase].children)),R(E.mathML,"mrow",null,t)}renderMmlPreSubSuper(e){var t=[],e=h(e.children,e=>e.type),r=e[u.MmlSuperArgument],a=e[u.MmlSubArgument],r=r?R(E.mathML,"mo",null,b(this.renderElement(r))):null,a=a?R(E.mathML,"mo",null,b(this.renderElement(a))):null,s=R(E.mathML,"mo",null);return t.push(R(E.mathML,"msubsup",null,[s,a,r])),t.push(...this.renderElements(e[u.MmlBase].children)),R(E.mathML,"mrow",null,t)}renderMmlGroupChar(e){var t="bot"===e.props.verticalJustification?"mover":"munder",t=this.renderContainerNS(e,E.mathML,t);return e.props.char&&t.appendChild(R(E.mathML,"mo",null,[e.props.char])),t}renderMmlBar(e){var t=this.renderContainerNS(e,E.mathML,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}renderMmlRun(e){var t=R(E.mathML,"ms");return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderChildren(e,t),t}renderMllList(e){var t,r=R(E.mathML,"mtable");this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),this.renderChildren(e);for(t of this.renderChildren(e))r.appendChild(R(E.mathML,"mtr",null,[R(E.mathML,"mtd",null,[t])]));return r}renderStyleValues(e,t){for(var r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){return e&&this.styleMap?.[e]}numberingClass(e,t){return this.className+`-num-${e}-`+t}tabStopClass(){return this.className+"-tab-stop"}styleToString(e,t,r=null){let a=e+` {\r
`;for(var s in t)s.startsWith("$")||(a+=`  ${s}: ${t[s]};\r
`);return r&&(a+=r),a+"}\r\n"}numberingCounter(e,t){return this.className+`-num-${e}-`+t}levelTextToContent(e,t,r,a){return`"${e.replace(/%\d*/g,e=>{e=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,e)}, ${a})"`})}${{tab:"\\9",space:"\\a0"}[t]??""}"`}numFormatToCssValue(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e]??e}refreshTabStops(){this.options.experimental&&(clearTimeout(this.tabsTimeout),this.tabsTimeout=setTimeout(()=>{e=document.body,(t=document.createElement("div")).style.width="100pt",e.appendChild(t),r=100/t.offsetWidth,e.removeChild(t);var e,t,r,a,s=r;for(a of this.currentTabs)((r,a,s,n)=>{var l=r.closest("p"),i=r.getBoundingClientRect(),o=l.getBoundingClientRect(),c=getComputedStyle(l);let e=0<a?.length?a.map(e=>({pos:Pe(e.position),leader:e.leader,style:e.style})).sort((e,t)=>e.pos-t.pos):[Se];var a=e[e.length-1],t=o.width*n,h=Pe(s);let p=a.pos+h;if(p<t)for(;p<t&&e.length<50;p+=h)e.push({...Se,pos:p});s=parseFloat(c.marginLeft),a=o.left+s;let u=(i.left-a)*n;if(null!=(c=e.find(e=>"clear"!=e.style&&e.pos>u))){let t=1;if("right"==c.style||"center"==c.style){let e=Array.from(l.querySelectorAll("."+r.className));i=e.indexOf(r)+1,a=document.createRange(),i=(a.setStart(r,1),i<e.length?a.setEndBefore(e[i]):a.setEndAfter(l),"center"==c.style?.5:1),l=a.getBoundingClientRect(),a=l.left+i*l.width-(o.left-s);t=c.pos-a*n}else t=c.pos-u;switch(r.innerHTML="&nbsp;",r.style.textDecoration="inherit",r.style.wordSpacing=t.toFixed(0)+"pt",c.leader){case"dot":case"middleDot":r.style.textDecoration="underline",r.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":r.style.textDecoration="underline"}}})(a.span,a.stops,this.defaultTabSize,s)},500))}}function D(e,t,r){return R(void 0,e,t,r)}function Me(e,t,r){return R(E.svg,e,t,r)}function R(e,t,r,a){e=e?document.createElementNS(e,t):document.createElement(t);return Object.assign(e,r),a&&Ne(e,a),e}function Ce(e){e.innerHTML=""}function Ne(r,e){e.forEach(e=>{return r.appendChild("string"==typeof(t=e)||t instanceof String?document.createTextNode(e):e);var t})}function B(e){return D("style",{innerHTML:e})}function L(e,t){e.appendChild(document.createComment(t))}let F={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,trimXmlDeclaration:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,renderChanges:!1,useBase64URL:!1,useLastRenderedPageBreak:!0};function Ae(e,t){t={...F,...t};return he.load(e,new ve(t),t)}async function Te(e,t,r,a){var a={...F,...a},s=new xe(window.document);return s.render(e,t,r,a),Promise.allSettled(s.tasks.filter(e=>e))}e.defaultOptions=F,e.praseAsync=Ae,e.renderAsync=async function(e,t,r,a){return await Te(e=await Ae(e,a),t,r,a),e},e.renderDocument=Te});
//# sourceMappingURL=docx-preview.min.js.map