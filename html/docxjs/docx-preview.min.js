((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jszip")):"function"==typeof define&&define.amd?define(["exports","jszip"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).docx={},e.JSZip)})(this,function(e,I){var a,d,t;function s(e){return/^[^"'].*\s.*[^"']$/.test(e)?`'${e}'`:e}function n(e){var t=e.lastIndexOf("/")+1;return[0==t?"":e.substring(0,t),0==t?e:e.substring(t)]}function l(e,t){try{var r="http://docx/";return new URL(e,r+t).toString().substring(r.length)}catch{return""+t+e}}function c(e,r){return e.reduce((e,t)=>(e[r(t)]=t,e),{})}function i(e){return e&&"object"==typeof e&&!Array.isArray(e)}function o(e,...t){if(!t.length)return e;var r=t.shift();if(i(e)&&i(r))for(var a in r)i(r[a])?o(e[a]??(e[a]={}),r[a]):e[a]=r[a];return o(e,...t)}function h(e){return Array.isArray(e)?e:[e]}(t=a=a||{}).OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",t.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",t.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",t.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",t.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",t.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",t.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",t.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",t.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",t.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",t.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",t.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",t.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",t.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",t.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",t.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",t.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",t.CommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",t.AltChunk="http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk";let m={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",drawingml:"http://schemas.openxmlformats.org/drawingml/2006/main",picture:"http://schemas.openxmlformats.org/drawingml/2006/picture",compatibility:"http://schemas.openxmlformats.org/markup-compatibility/2006",math:"http://schemas.openxmlformats.org/officeDocument/2006/math"},p={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt",min:.25,max:12},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"},LineHeight:{mul:1/240,unit:""},VmlEmu:{mul:1/12700,unit:""}};function u(e,t=p.Dxa){var r,a,s;return null==e||/.+(p[xt]|[%])$/.test(e)?e:(e=parseInt(e)*t.mul,t.min&&t.max&&(r=e,a=t.min,s=t.max,e=r<a?a:s<r?s:r),""+e.toFixed(2)+t.unit)}function g(e,t,r){if(e.namespaceURI==m.wordml){switch(e.localName){case"color":t.color=r.attr(e,"val");break;case"sz":t.fontSize=r.lengthAttr(e,"val",p.FontSize);break;default:return}return 1}}class r{elements(r,a=null){var s=[];for(let e=0,t=r.childNodes.length;e<t;e++){var n=r.childNodes.item(e);1!=n.nodeType||null!=a&&n.localName!=a||s.push(n)}return s}element(r,a){for(let e=0,t=r.childNodes.length;e<t;e++){var s=r.childNodes.item(e);if(1==s.nodeType&&s.localName==a)return s}return null}elementAttr(e,t,r){e=this.element(e,t);return e?this.attr(e,r):void 0}attrs(e){return Array.from(e.attributes)}attr(r,a){for(let e=0,t=r.attributes.length;e<t;e++){var s=r.attributes.item(e);if(s.localName==a)return s.value}return null}intAttr(e,t,r=null){e=this.attr(e,t);return e?parseInt(e):r}hexAttr(e,t,r=null){e=this.attr(e,t);return e?parseInt(e,16):r}floatAttr(e,t,r=null){e=this.attr(e,t);return e?parseFloat(e):r}boolAttr(e,t,r=null){var[e,a=!1]=[this.attr(e,t),r];switch(e){case"1":return!0;case"0":return!1;case"on":return!0;case"off":return!1;case"true":return!0;case"false":return!1;default:return a}}lengthAttr(e,t,r=p.Dxa){return u(this.attr(e,t),r)}}let b=new r;class f{constructor(e,t){this._package=e,this.path=t}async load(){this.rels=await this._package.loadRelationships(this.path);var e=await this._package.load(this.path),e=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=e),this.parseXml(e.firstElementChild)}save(){var e;this._package.update(this.path,(e=this._xmlDocument,(new XMLSerializer).serializeToString(e)))}parseXml(e){}}let O={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function $(e,s){return s.elements(e).map(e=>{var t,r=s,a={name:r.attr(e,"name"),embedFontRefs:[]};for(t of r.elements(e))switch(t.localName){case"family":a.family=r.attr(t,"val");break;case"altName":a.altName=r.attr(t,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":a.embedFontRefs.push(((e,t)=>({id:t.attr(e,"id"),key:t.attr(e,"fontKey"),type:O[e.localName]}))(t,r))}return a})}class H extends f{parseXml(e){this.fonts=$(e,this._package.xmlParser)}}class y{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new r}get(e){e=(e=e).startsWith("/")?e.substr(1):e;return this._zip.files[e]??this._zip.files[e.replace(/\//g,"\\")]}update(e,t){this._zip.file(e,t)}static async load(e,t){e=await I.loadAsync(e);return new y(e,t)}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){return this.get(e)?.async(t)??Promise.resolve(null)}async loadRelationships(e=null){let t="_rels/.rels";null!=e&&([e,r]=n(e),t=e+`_rels/${r}.rels`);var r,a,e=await this.load(t);return e?(r=this.parseXmlDocument(e).firstElementChild,(a=this.xmlParser).elements(r).map(e=>({id:a.attr(e,"Id"),type:a.attr(e,"Type"),target:a.attr(e,"Target"),targetMode:a.attr(e,"TargetMode")}))):null}parseXmlDocument(e){var[e,t=!1]=[e,this.options.trimXmlDeclaration];if(t&&(e=e.replace(/<[?].*[?]>/,"")),e=65279===(t=e).charCodeAt(0)?t.substring(1):t,t=(new DOMParser).parseFromString(e,"application/xml"),e=t.getElementsByTagName("parsererror")[0]?.textContent)throw new Error(e);return t}}class _ extends f{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}}function k(e,t){return{type:t.attr(e,"val"),color:t.attr(e,"color"),size:t.lengthAttr(e,"sz",p.Border),offset:t.lengthAttr(e,"space",p.Point),frame:t.boolAttr(e,"frame"),shadow:t.boolAttr(e,"shadow")}}function v(e,t=b){var r,a,s,n={};for(r of t.elements(e))switch(r.localName){case"pgSz":n.pageSize={width:t.lengthAttr(r,"w"),height:t.lengthAttr(r,"h"),orientation:t.attr(r,"orient")};break;case"type":n.type=t.attr(r,"val");break;case"pgMar":n.pageMargins={left:t.lengthAttr(r,"left"),right:t.lengthAttr(r,"right"),top:t.lengthAttr(r,"top"),bottom:t.lengthAttr(r,"bottom"),header:t.lengthAttr(r,"header"),footer:t.lengthAttr(r,"footer"),gutter:t.lengthAttr(r,"gutter")};break;case"cols":n.columns=((e,t)=>({numberOfColumns:t.intAttr(e,"num"),space:t.lengthAttr(e,"space"),separator:t.boolAttr(e,"sep"),equalWidth:t.boolAttr(e,"equalWidth",!0),columns:t.elements(e,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}))(r,t);break;case"headerReference":(n.headerRefs??(n.headerRefs=[])).push(S(r,t));break;case"footerReference":(n.footerRefs??(n.footerRefs=[])).push(S(r,t));break;case"titlePg":n.titlePage=t.boolAttr(r,"val",!0);break;case"pgBorders":n.pageBorders=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"left":a.left=k(r,t);break;case"top":a.top=k(r,t);break;case"right":a.right=k(r,t);break;case"bottom":a.bottom=k(r,t)}return a})(r,t);break;case"pgNumType":n.pageNumber=(a=r,{chapSep:(s=t).attr(a,"chapSep"),chapStyle:s.attr(a,"chapStyle"),format:s.attr(a,"fmt"),start:s.intAttr(a,"start")})}return n}function S(e,t){return{id:t.attr(e,"id"),type:t.attr(e,"type")}}function w(t,r){var a={};for(let e of r.elements(t))g(e,a,r);return a}function P(e,t){var r,a={};for(r of t.elements(e))C(r,a,t);return a}function C(e,t,r){if(e.namespaceURI==m.wordml){var a,s,n;if(!g(e,t,r))switch(e.localName){case"tabs":t.tabs=(n=r).elements(e,"tab").map(e=>({position:n.lengthAttr(e,"pos"),leader:n.attr(e,"leader"),style:n.attr(e,"val")}));break;case"sectPr":t.sectionProps=v(e,r);break;case"numPr":t.numbering=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"numId":a.id=t.attr(r,"val");break;case"ilvl":a.level=t.intAttr(r,"val")}return a})(e,r);break;case"spacing":return void(t.lineSpacing=(a=e,{before:(s=r).lengthAttr(a,"before"),after:s.lengthAttr(a,"after"),line:s.intAttr(a,"line"),lineRule:s.attr(a,"lineRule")}));case"textAlignment":return void(t.textAlignment=r.attr(e,"val"));case"keepLines":t.keepLines=r.boolAttr(e,"val",!0);break;case"keepNext":t.keepNext=r.boolAttr(e,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=r.boolAttr(e,"val",!0);break;case"outlineLvl":t.outlineLevel=r.intAttr(e,"val");break;case"pStyle":t.styleName=r.attr(e,"val");break;case"rPr":t.runProps=w(e,r);break;default:return}return 1}}function V(e,t){var r,a,s,n,l,i={numberings:[],abstractNumberings:[],bulletPictures:[]};for(r of t.elements(e))switch(r.localName){case"num":i.numberings.push(((e,t)=>{var r,a={id:t.attr(e,"numId"),overrides:[]};for(r of t.elements(e))switch(r.localName){case"abstractNumId":a.abstractId=t.attr(r,"val");break;case"lvlOverride":a.overrides.push(((e,t)=>{var r,a={level:t.intAttr(e,"ilvl")};for(r of t.elements(e))switch(r.localName){case"startOverride":a.start=t.intAttr(r,"val");break;case"lvl":a.numberingLevel=x(r,t)}return a})(r,t))}return a})(r,t));break;case"abstractNum":i.abstractNumberings.push(((e,t)=>{var r,a={id:t.attr(e,"abstractNumId"),levels:[]};for(r of t.elements(e))switch(r.localName){case"name":a.name=t.attr(r,"val");break;case"multiLevelType":a.multiLevelType=t.attr(r,"val");break;case"numStyleLink":a.numberingStyleLink=t.attr(r,"val");break;case"styleLink":a.styleLink=t.attr(r,"val");break;case"lvl":a.levels.push(x(r,t))}return a})(r,t));break;case"numPicBullet":i.bulletPictures.push((a=r,void 0,l=n=void 0,n=(n=(s=t).element(a,"pict"))&&s.element(n,"shape"),(l=n&&s.element(n,"imagedata"))?{id:s.attr(a,"numPicBulletId"),referenceId:s.attr(l,"id"),style:s.attr(n,"style")}:null))}return i}function x(e,t){var r,a={level:t.intAttr(e,"ilvl")};for(r of t.elements(e))switch(r.localName){case"start":a.start=t.attr(r,"val");break;case"lvlRestart":a.restart=t.intAttr(r,"val");break;case"numFmt":a.format=t.attr(r,"val");break;case"lvlText":a.text=t.attr(r,"val");break;case"lvlJc":a.justification=t.attr(r,"val");break;case"lvlPicBulletId":a.bulletPictureId=t.attr(r,"val");break;case"pStyle":a.paragraphStyle=t.attr(r,"val");break;case"pPr":a.paragraphProps=P(r,t);break;case"rPr":a.runProps=w(r,t)}return a}class z extends f{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){Object.assign(this,V(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}}class j extends f{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}}(t=d=d||{}).Document="document",t.Paragraph="paragraph",t.Run="run",t.Break="break",t.NoBreakHyphen="noBreakHyphen",t.Table="table",t.Row="row",t.Cell="cell",t.Hyperlink="hyperlink",t.SmartTag="smartTag",t.Drawing="drawing",t.Image="image",t.Text="text",t.Tab="tab",t.Symbol="symbol",t.BookmarkStart="bookmarkStart",t.BookmarkEnd="bookmarkEnd",t.Footer="footer",t.Header="header",t.FootnoteReference="footnoteReference",t.EndnoteReference="endnoteReference",t.Footnote="footnote",t.Endnote="endnote",t.SimpleField="simpleField",t.ComplexField="complexField",t.Instruction="instruction",t.VmlPicture="vmlPicture",t.MmlMath="mmlMath",t.MmlMathParagraph="mmlMathParagraph",t.MmlFraction="mmlFraction",t.MmlFunction="mmlFunction",t.MmlFunctionName="mmlFunctionName",t.MmlNumerator="mmlNumerator",t.MmlDenominator="mmlDenominator",t.MmlRadical="mmlRadical",t.MmlBase="mmlBase",t.MmlDegree="mmlDegree",t.MmlSuperscript="mmlSuperscript",t.MmlSubscript="mmlSubscript",t.MmlPreSubSuper="mmlPreSubSuper",t.MmlSubArgument="mmlSubArgument",t.MmlSuperArgument="mmlSuperArgument",t.MmlNary="mmlNary",t.MmlDelimiter="mmlDelimiter",t.MmlRun="mmlRun",t.MmlEquationArray="mmlEquationArray",t.MmlLimit="mmlLimit",t.MmlLimitLower="mmlLimitLower",t.MmlMatrix="mmlMatrix",t.MmlMatrixRow="mmlMatrixRow",t.MmlBox="mmlBox",t.MmlBar="mmlBar",t.MmlGroupChar="mmlGroupChar",t.VmlElement="vmlElement",t.Inserted="inserted",t.Deleted="deleted",t.DeletedText="deletedText",t.Comment="comment",t.CommentReference="commentReference",t.CommentRangeStart="commentRangeStart",t.CommentRangeEnd="commentRangeEnd",t.AltChunk="altChunk";class M{constructor(){this.children=[],this.cssStyle={}}}class W extends M{constructor(){super(...arguments),this.type=d.Header}}class X extends M{constructor(){super(...arguments),this.type=d.Footer}}class N extends f{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}}class G extends N{createRootElement(){return new W}}class U extends N{createRootElement(){return new X}}function E(e){if(void 0!==e)return parseInt(e)}class q extends f{parseXml(e){this.props=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"Template":a.template=r.textContent;break;case"Pages":a.pages=E(r.textContent);break;case"Words":a.words=E(r.textContent);break;case"Characters":a.characters=E(r.textContent);break;case"Application":a.application=r.textContent;break;case"Lines":a.lines=E(r.textContent);break;case"Paragraphs":a.paragraphs=E(r.textContent);break;case"Company":a.company=r.textContent;break;case"AppVersion":a.appVersion=r.textContent}return a})(e,this._package.xmlParser)}}class J extends f{parseXml(e){this.props=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"title":a.title=r.textContent;break;case"description":a.description=r.textContent;break;case"subject":a.subject=r.textContent;break;case"creator":a.creator=r.textContent;break;case"keywords":a.keywords=r.textContent;break;case"language":a.language=r.textContent;break;case"lastModifiedBy":a.lastModifiedBy=r.textContent;break;case"revision":r.textContent&&(a.revision=parseInt(r.textContent))}return a})(e,this._package.xmlParser)}}class Z{}function K(e,t){var r,a=new Z,e=t.element(e,"themeElements");for(r of t.elements(e))switch(r.localName){case"clrScheme":a.colorScheme=((e,t)=>{var r,a={name:t.attr(e,"name"),colors:{}};for(r of t.elements(e)){var s=t.element(r,"srgbClr"),n=t.element(r,"sysClr");s?a.colors[r.localName]=t.attr(s,"val"):n&&(a.colors[r.localName]=t.attr(n,"lastClr"))}return a})(r,t);break;case"fontScheme":a.fontScheme=((e,t)=>{var r,a={name:t.attr(e,"name")};for(r of t.elements(e))switch(r.localName){case"majorFont":a.majorFont=A(r,t);break;case"minorFont":a.minorFont=A(r,t)}return a})(r,t)}return a}function A(e,t){return{latinTypeface:t.elementAttr(e,"latin","typeface"),eaTypeface:t.elementAttr(e,"ea","typeface"),csTypeface:t.elementAttr(e,"cs","typeface")}}class Y extends f{constructor(e,t){super(e,t)}parseXml(e){this.theme=K(e,this._package.xmlParser)}}class T{}class Q extends T{constructor(){super(...arguments),this.type=d.Footnote}}class ee extends T{constructor(){super(...arguments),this.type=d.Endnote}}class R extends f{constructor(e,t,r){super(e,t),this._documentParser=r}}class te extends R{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",Q)}}class re extends R{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",ee)}}function ae(e,t){var r,a={defaultNoteIds:[]};for(r of t.elements(e))switch(r.localName){case"numFmt":a.nummeringFormat=t.attr(r,"val");break;case"footnote":case"endnote":a.defaultNoteIds.push(t.attr(r,"id"))}return a}class se extends f{constructor(e,t){super(e,t)}parseXml(e){this.settings=((e,t)=>{var r,a={};for(r of t.elements(e))switch(r.localName){case"defaultTabStop":a.defaultTabStop=t.lengthAttr(r,"val");break;case"footnotePr":a.footnoteProps=ae(r,t);break;case"endnotePr":a.endnoteProps=ae(r,t);break;case"autoHyphenation":a.autoHyphenation=t.boolAttr(r,"val")}return a})(e,this._package.xmlParser)}}class ne extends f{parseXml(e){var r;this.props=(r=this._package.xmlParser).elements(e,"property").map(e=>{var t=e.firstChild;return{formatId:r.attr(e,"fmtid"),name:r.attr(e,"name"),type:t.nodeName,value:t.textContent}})}}class le extends f{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.comments=this._documentParser.parseComments(e),this.commentMap=c(this.comments,e=>e.id)}}class ie extends f{constructor(e,t){super(e,t),this.comments=[]}parseXml(e){var t,r=this._package.xmlParser;for(t of r.elements(e,"commentEx"))this.comments.push({paraId:r.attr(t,"paraId"),paraIdParent:r.attr(t,"paraIdParent"),done:r.boolAttr(t,"done")});this.commentMap=c(this.comments,e=>e.paraId)}}let oe=[{type:a.OfficeDocument,target:"word/document.xml"},{type:a.ExtendedProperties,target:"docProps/app.xml"},{type:a.CoreProperties,target:"docProps/core.xml"},{type:a.CustomProperties,target:"docProps/custom.xml"}];class ce{constructor(){this.parts=[],this.partsMap={}}static async load(e,t,r){var a=new ce;return a._options=r,a._parser=t,a._package=await y.load(e,r),a.rels=await a._package.loadRelationships(),await Promise.all(oe.map(t=>{var e=a.rels.find(e=>e.type===t.type)??t;return a.loadRelationshipPart(e.target,e.type)})),a}save(e="blob"){return this._package.save(e)}async loadRelationshipPart(e,t){if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let r=null;switch(t){case a.OfficeDocument:this.documentPart=r=new _(this._package,e,this._parser);break;case a.FontTable:this.fontTablePart=r=new H(this._package,e);break;case a.Numbering:this.numberingPart=r=new z(this._package,e,this._parser);break;case a.Styles:this.stylesPart=r=new j(this._package,e,this._parser);break;case a.Theme:this.themePart=r=new Y(this._package,e);break;case a.Footnotes:this.footnotesPart=r=new te(this._package,e,this._parser);break;case a.Endnotes:this.endnotesPart=r=new re(this._package,e,this._parser);break;case a.Footer:r=new U(this._package,e,this._parser);break;case a.Header:r=new G(this._package,e,this._parser);break;case a.CoreProperties:this.corePropsPart=r=new J(this._package,e);break;case a.ExtendedProperties:this.extendedPropsPart=r=new q(this._package,e);break;case a.CustomProperties:r=new ne(this._package,e);break;case a.Settings:this.settingsPart=r=new se(this._package,e);break;case a.Comments:this.commentsPart=r=new le(this._package,e,this._parser);break;case a.CommentsExtended:this.commentsExtendedPart=r=new ie(this._package,e)}if(null==r)return Promise.resolve(null);if(this.partsMap[e]=r,this.parts.push(r),await r.load(),0<r.rels?.length){let[t]=n(r.path);await Promise.all(r.rels.map(e=>this.loadRelationshipPart(l(e.target,t),e.type)))}return r}async loadDocumentImage(e,t){t=await this.loadResource(t??this.documentPart,e,"blob");return this.blobToURL(t)}async loadNumberingImage(e){e=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(e)}async loadFont(e,t){e=await this.loadResource(this.fontTablePart,e,"uint8array");return e&&this.blobToURL(new Blob([((t,e)=>{var r=e.replace(/{|}|-/g,""),a=new Array(16);for(let e=0;e<16;e++)a[16-e-1]=parseInt(r.substr(2*e,2),16);for(let e=0;e<32;e++)t[e]=t[e]^a[e%16];return t})(e,t)]))}async loadAltChunk(e,t){return this.loadResource(t??this.documentPart,e,"string")}blobToURL(e){var a;return e?this._options.useBase64URL?(a=e,new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=()=>t(),r.readAsDataURL(a)})):URL.createObjectURL(e):null}findPartByRelId(t,e=null){var r=(e.rels??this.rels).find(e=>e.id==t),e=e?n(e.path)[0]:"";return r?this.partsMap[l(r.target,e)]:null}getPathById(e,t){var r=e.rels.find(e=>e.id==t),[e]=n(e.path);return r?l(r.target,e):null}loadResource(e,t,r){e=this.getPathById(e,t);return e?this._package.load(e,r):Promise.resolve(null)}}class he extends M{constructor(){super(...arguments),this.type=d.VmlElement,this.attrs={}}}function me(e,t){var r,a,s=new he;switch(e.localName){case"rect":s.tagName="rect",Object.assign(s.attrs,{width:"100%",height:"100%"});break;case"oval":s.tagName="ellipse",Object.assign(s.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":s.tagName="line";break;case"shape":s.tagName="g";break;case"textbox":s.tagName="foreignObject",Object.assign(s.attrs,{width:"100%",height:"100%"});break;default:return null}for(r of b.attrs(e))switch(r.localName){case"style":s.cssStyleText=r.value;break;case"fillcolor":s.attrs.fill=r.value;break;case"from":var[n,l]=pe(r.value);Object.assign(s.attrs,{x1:n,y1:l});break;case"to":var[n,l]=pe(r.value);Object.assign(s.attrs,{x2:n,y2:l})}for(a of b.elements(e))switch(a.localName){case"stroke":Object.assign(s.attrs,(i=a,{stroke:b.attr(i,"color"),"stroke-width":b.lengthAttr(i,"weight",p.Emu)??"1px"}));break;case"fill":Object.assign(s.attrs,{});break;case"imagedata":s.tagName="image",Object.assign(s.attrs,{width:"100%",height:"100%"}),s.imageHref={id:b.attr(a,"id"),title:b.attr(a,"title")};break;case"txbxContent":s.children.push(...t.parseBodyElements(a));break;default:var i=me(a,t);i&&s.children.push(i)}return s}function pe(e){return e.split(",")}class de extends M{constructor(){super(...arguments),this.type=d.Comment}}class ue extends M{constructor(e){super(),this.id=e,this.type=d.CommentReference}}class ge extends M{constructor(e){super(),this.id=e,this.type=d.CommentRangeStart}}class be extends M{constructor(e){super(),this.id=e,this.type=d.CommentRangeEnd}}var fe="inherit",ye="black",ke="black",ve="transparent";let Se=[],we={oMath:d.MmlMath,oMathPara:d.MmlMathParagraph,f:d.MmlFraction,func:d.MmlFunction,fName:d.MmlFunctionName,num:d.MmlNumerator,den:d.MmlDenominator,rad:d.MmlRadical,deg:d.MmlDegree,e:d.MmlBase,sSup:d.MmlSuperscript,sSub:d.MmlSubscript,sPre:d.MmlPreSubSuper,sup:d.MmlSuperArgument,sub:d.MmlSubArgument,d:d.MmlDelimiter,nary:d.MmlNary,eqArr:d.MmlEquationArray,lim:d.MmlLimit,limLow:d.MmlLimitLower,m:d.MmlMatrix,mr:d.MmlMatrixRow,box:d.MmlBox,bar:d.MmlBar,groupChr:d.MmlGroupChar};class Pe{constructor(e){this.options={ignoreWidth:!1,debug:!1,...e}}parseNotes(e,t,r){var a,s=[];for(a of b.elements(e,t)){var n=new r;n.id=b.attr(a,"id"),n.noteType=b.attr(a,"type"),n.children=this.parseBodyElements(a),s.push(n)}return s}parseComments(e){var t,r=[];for(t of b.elements(e,"comment")){var a=new de;a.id=b.attr(t,"id"),a.author=b.attr(t,"author"),a.initials=b.attr(t,"initials"),a.date=b.attr(t,"date"),a.children=this.parseBodyElements(t),r.push(a)}return r}parseDocumentFile(e){var t=b.element(e,"body"),e=b.element(e,"background"),r=b.element(t,"sectPr");return{type:d.Document,children:this.parseBodyElements(t),props:r?v(r,b):{},cssStyle:e?this.parseBackground(e):{}}}parseBackground(e){var t={},e=D.colorAttr(e,"color");return e&&(t["background-color"]=e),t}parseBodyElements(e){var t,r=[];for(t of b.elements(e))switch(t.localName){case"p":r.push(this.parseParagraph(t));break;case"altChunk":r.push(this.parseAltChunk(t));break;case"tbl":r.push(this.parseTable(t));break;case"sdt":r.push(...this.parseSdt(t,e=>this.parseBodyElements(e)))}return r}parseStylesFile(e){var t=[];return D.foreach(e,e=>{switch(e.localName){case"style":t.push(this.parseStyle(e));break;case"docDefaults":t.push(this.parseDefaultStyles(e))}}),t}parseDefaultStyles(e){var r={id:null,name:null,target:null,basedOn:null,styles:[]};return D.foreach(e,e=>{switch(e.localName){case"rPrDefault":var t=b.element(e,"rPr");t&&r.styles.push({target:"span",values:this.parseDefaultProperties(t,{})});break;case"pPrDefault":t=b.element(e,"pPr");t&&r.styles.push({target:"p",values:this.parseDefaultProperties(t,{})})}}),r}parseStyle(e){var r={id:b.attr(e,"styleId"),isDefault:b.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(b.attr(e,"type")){case"paragraph":r.target="p";break;case"table":r.target="table";break;case"character":r.target="span"}return D.foreach(e,e=>{switch(e.localName){case"basedOn":r.basedOn=b.attr(e,"val");break;case"name":r.name=b.attr(e,"val");break;case"link":r.linked=b.attr(e,"val");break;case"next":r.next=b.attr(e,"val");break;case"aliases":r.aliases=b.attr(e,"val").split(",");break;case"pPr":r.styles.push({target:"p",values:this.parseDefaultProperties(e,{})}),r.paragraphProps=P(e,b);break;case"rPr":r.styles.push({target:"span",values:this.parseDefaultProperties(e,{})}),r.runProps=w(e,b);break;case"tblPr":case"tcPr":r.styles.push({target:"td",values:this.parseDefaultProperties(e,{})});break;case"tblStylePr":for(var t of this.parseTableStyle(e))r.styles.push(t);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn("DOCX: Unknown style element: "+e.localName)}}),r}parseTableStyle(e){var t=[],r=b.attr(e,"type"),a="",s="";switch(r){case"firstRow":s=".first-row",a="tr.first-row td";break;case"lastRow":s=".last-row",a="tr.last-row td";break;case"firstCol":s=".first-col",a="td.first-col";break;case"lastCol":s=".last-col",a="td.last-col";break;case"band1Vert":s=":not(.no-vband)",a="td.odd-col";break;case"band2Vert":s=":not(.no-vband)",a="td.even-col";break;case"band1Horz":s=":not(.no-hband)",a="tr.odd-row";break;case"band2Horz":s=":not(.no-hband)",a="tr.even-row";break;default:return[]}return D.foreach(e,e=>{switch(e.localName){case"pPr":t.push({target:a+" p",mod:s,values:this.parseDefaultProperties(e,{})});break;case"rPr":t.push({target:a+" span",mod:s,values:this.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":t.push({target:a,mod:s,values:this.parseDefaultProperties(e,{})})}}),t}parseNumberingFile(e){var a=[],s={},n=[];return D.foreach(e,e=>{switch(e.localName){case"abstractNum":this.parseAbstractNumbering(e,n).forEach(e=>a.push(e));break;case"numPicBullet":n.push(this.parseNumberingPicBullet(e));break;case"num":var t=b.attr(e,"numId"),r=b.elementAttr(e,"abstractNumId","val");s[r]=t}}),a.forEach(e=>e.id=s[e.id]),a}parseNumberingPicBullet(e){var t=b.element(e,"pict"),t=t&&b.element(t,"shape"),r=t&&b.element(t,"imagedata");return r?{id:b.intAttr(e,"numPicBulletId"),src:b.attr(r,"id"),style:b.attr(t,"style")}:null}parseAbstractNumbering(e,t){var r=[],a=b.attr(e,"abstractNumId");return D.foreach(e,e=>{"lvl"===e.localName&&r.push(this.parseNumberingLevel(a,e,t))}),r}parseNumberingLevel(e,t,r){var a={id:e,level:b.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return D.foreach(t,e=>{switch(e.localName){case"start":a.start=b.intAttr(e,"val");break;case"pPr":this.parseDefaultProperties(e,a.pStyle);break;case"rPr":this.parseDefaultProperties(e,a.rStyle);break;case"lvlPicBulletId":var t=b.intAttr(e,"val");a.bullet=r.find(e=>e?.id==t);break;case"lvlText":a.levelText=b.attr(e,"val");break;case"pStyle":a.pStyleName=b.attr(e,"val");break;case"numFmt":a.format=b.attr(e,"val");break;case"suff":a.suff=b.attr(e,"val")}}),a}parseSdt(e,t){e=b.element(e,"sdtContent");return e?t(e):[]}parseInserted(e,t){return{type:d.Inserted,children:t(e)?.children??[]}}parseDeleted(e,t){return{type:d.Deleted,children:t(e)?.children??[]}}parseAltChunk(e){return{type:d.AltChunk,children:[],id:b.attr(e,"id")}}parseParagraph(e){var t,r,a,s={type:d.Paragraph,children:[]};for(t of b.elements(e))switch(t.localName){case"pPr":this.parseParagraphProperties(t,s);break;case"r":s.children.push(this.parseRun(t,s));break;case"hyperlink":s.children.push(this.parseHyperlink(t,s));break;case"smartTag":s.children.push(this.parseSmartTag(t,s));break;case"bookmarkStart":s.children.push((r=t,a=b,{type:d.BookmarkStart,id:a.attr(r,"id"),name:a.attr(r,"name"),colFirst:a.intAttr(r,"colFirst"),colLast:a.intAttr(r,"colLast")}));break;case"bookmarkEnd":s.children.push((a=t,r=b,{type:d.BookmarkEnd,id:r.attr(a,"id")}));break;case"commentRangeStart":s.children.push(new ge(b.attr(t,"id")));break;case"commentRangeEnd":s.children.push(new be(b.attr(t,"id")));break;case"oMath":case"oMathPara":s.children.push(this.parseMathElement(t));break;case"sdt":s.children.push(...this.parseSdt(t,e=>this.parseParagraph(e).children));break;case"ins":s.children.push(this.parseInserted(t,e=>this.parseParagraph(e)));break;case"del":s.children.push(this.parseDeleted(t,e=>this.parseParagraph(e)))}return s}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{if(!C(e,t,b))switch(e.localName){case"pStyle":t.styleName=b.attr(e,"val");break;case"cnfStyle":t.className=B.classNameOfCnfStyle(e);break;case"framePr":this.parseFrame(e,t);break;case"rPr":break;default:return!1}return!0})}parseFrame(e,t){"drop"==b.attr(e,"dropCap")&&(t.cssStyle.float="left")}parseHyperlink(e,t){var r={type:d.Hyperlink,parent:t,children:[]};return r.anchor=b.attr(e,"anchor"),r.id=b.attr(e,"id"),D.foreach(e,e=>{"r"===e.localName&&r.children.push(this.parseRun(e,r))}),r}parseSmartTag(e,t){var r={type:d.SmartTag,parent:t,children:[]},t=b.attr(e,"uri"),a=b.attr(e,"element");return t&&(r.uri=t),a&&(r.element=a),D.foreach(e,e=>{"r"===e.localName&&r.children.push(this.parseRun(e,r))}),r}parseRun(e,t){var r={type:d.Run,parent:t,children:[]};return D.foreach(e,e=>{switch((e=this.checkAlternateContent(e)).localName){case"t":r.children.push({type:d.Text,text:e.textContent});break;case"delText":r.children.push({type:d.DeletedText,text:e.textContent});break;case"commentReference":r.children.push(new ue(b.attr(e,"id")));break;case"fldSimple":r.children.push({type:d.SimpleField,instruction:b.attr(e,"instr"),lock:b.boolAttr(e,"lock",!1),dirty:b.boolAttr(e,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:d.Instruction,text:e.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:d.ComplexField,charType:b.attr(e,"fldCharType"),lock:b.boolAttr(e,"lock",!1),dirty:b.boolAttr(e,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:d.NoBreakHyphen});break;case"br":r.children.push({type:d.Break,break:b.attr(e,"type")||"textWrapping"});break;case"lastRenderedPageBreak":r.children.push({type:d.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:d.Symbol,font:s(b.attr(e,"font")),char:b.attr(e,"char")});break;case"tab":r.children.push({type:d.Tab});break;case"footnoteReference":r.children.push({type:d.FootnoteReference,id:b.attr(e,"id")});break;case"endnoteReference":r.children.push({type:d.EndnoteReference,id:b.attr(e,"id")});break;case"drawing":var t=this.parseDrawing(e);t&&(r.children=[t]);break;case"pict":r.children.push(this.parseVmlPicture(e));break;case"rPr":this.parseRunProperties(e,r)}}),r}parseMathElement(e){var t,r,a=e.localName+"Pr",s={type:we[e.localName],children:[]};for(t of b.elements(e))we[t.localName]?s.children.push(this.parseMathElement(t)):"r"==t.localName?((r=this.parseRun(t)).type=d.MmlRun,s.children.push(r)):t.localName==a&&(s.props=this.parseMathProperies(t));return s}parseMathProperies(e){var t,r={};for(t of b.elements(e))switch(t.localName){case"chr":r.char=b.attr(t,"val");break;case"vertJc":r.verticalJustification=b.attr(t,"val");break;case"pos":r.position=b.attr(t,"val");break;case"degHide":r.hideDegree=b.boolAttr(t,"val");break;case"begChr":r.beginChar=b.attr(t,"val");break;case"endChr":r.endChar=b.attr(t,"val")}return r}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{switch(e.localName){case"rStyle":t.styleName=b.attr(e,"val");break;case"vertAlign":t.verticalAlign=B.valueOfVertAlign(e,!0);break;default:return!1}return!0})}parseVmlPicture(e){var t,r={type:d.VmlPicture,children:[]};for(t of b.elements(e)){var a=me(t,this);a&&r.children.push(a)}return r}checkAlternateContent(e){if("AlternateContent"!=e.localName)return e;var t=b.element(e,"Choice");if(t){var r=b.attr(t,"Requires"),r=e.lookupNamespaceURI(r);if(Se.includes(r))return t.firstElementChild}return b.element(e,"Fallback")?.firstElementChild}parseDrawing(e){for(var t of b.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){let t={type:d.Drawing,children:[],cssStyle:{}},r="anchor"==e.localName,a=null;var s,n,l,i=b.boolAttr(e,"simplePos"),o=(b.boolAttr(e,"behindDoc"),{relative:"page",align:"left",offset:"0"}),c={relative:"page",align:"top",offset:"0"};for(s of b.elements(e))switch(s.localName){case"simplePos":i&&(o.offset=b.lengthAttr(s,"x",p.Emu),c.offset=b.lengthAttr(s,"y",p.Emu));break;case"extent":t.cssStyle.width=b.lengthAttr(s,"cx",p.Emu),t.cssStyle.height=b.lengthAttr(s,"cy",p.Emu);break;case"positionH":case"positionV":i||(n="positionH"==s.localName?o:c,h=b.element(s,"align"),l=b.element(s,"posOffset"),n.relative=b.attr(s,"relativeFrom")??n.relative,h&&(n.align=h.textContent),l&&(n.offset=D.sizeValue(l,p.Emu)));break;case"wrapTopAndBottom":a="wrapTopAndBottom";break;case"wrapNone":a="wrapNone";break;case"graphic":var h=this.parseGraphic(s);h&&t.children.push(h)}return"wrapTopAndBottom"==a?(t.cssStyle.display="block",o.align&&(t.cssStyle["text-align"]=o.align,t.cssStyle.width="100%")):"wrapNone"==a?(t.cssStyle.display="block",t.cssStyle.position="relative",t.cssStyle.width="0px",t.cssStyle.height="0px",o.offset&&(t.cssStyle.left=o.offset),c.offset&&(t.cssStyle.top=c.offset)):!r||"left"!=o.align&&"right"!=o.align||(t.cssStyle.float=o.align),t}parseGraphic(e){var t,e=b.element(e,"graphicData");for(t of b.elements(e))if("pic"===t.localName)return this.parsePicture(t);return null}parsePicture(e){var t,r={type:d.Image,src:"",cssStyle:{}},a=b.element(e,"blipFill"),a=b.element(a,"blip"),a=(r.src=b.attr(a,"embed"),b.element(e,"spPr")),e=b.element(a,"xfrm");r.cssStyle.position="relative";for(t of b.elements(e))switch(t.localName){case"ext":r.cssStyle.width=b.lengthAttr(t,"cx",p.Emu),r.cssStyle.height=b.lengthAttr(t,"cy",p.Emu);break;case"off":r.cssStyle.left=b.lengthAttr(t,"x",p.Emu),r.cssStyle.top=b.lengthAttr(t,"y",p.Emu)}return r}parseTable(e){var t={type:d.Table,children:[]};return D.foreach(e,e=>{switch(e.localName){case"tr":t.children.push(this.parseTableRow(e));break;case"tblGrid":t.columns=this.parseTableColumns(e);break;case"tblPr":this.parseTableProperties(e,t)}}),t}parseTableColumns(e){var t=[];return D.foreach(e,e=>{"gridCol"===e.localName&&t.push({width:b.lengthAttr(e,"w")})}),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,e=>{switch(e.localName){case"tblStyle":t.styleName=b.attr(e,"val");break;case"tblLook":t.className=B.classNameOftblLook(e);break;case"tblpPr":this.parseTablePosition(e,t);break;case"tblStyleColBandSize":t.colBandSize=b.intAttr(e,"val");break;case"tblStyleRowBandSize":t.rowBandSize=b.intAttr(e,"val");break;case"hidden":t.cssStyle.display="none";break;default:return!1}return!0}),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto"}}parseTablePosition(e,t){var r=b.lengthAttr(e,"topFromText"),a=b.lengthAttr(e,"bottomFromText"),s=b.lengthAttr(e,"rightFromText"),e=b.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=B.addSize(t.cssStyle["margin-bottom"],a),t.cssStyle["margin-left"]=B.addSize(t.cssStyle["margin-left"],e),t.cssStyle["margin-right"]=B.addSize(t.cssStyle["margin-right"],s),t.cssStyle["margin-top"]=B.addSize(t.cssStyle["margin-top"],r)}parseTableRow(e){var t={type:d.Row,children:[]};return D.foreach(e,e=>{switch(e.localName){case"tc":t.children.push(this.parseTableCell(e));break;case"trPr":this.parseTableRowProperties(e,t)}}),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"cnfStyle":t.className=B.classNameOfCnfStyle(e);break;case"tblHeader":t.isHeader=b.boolAttr(e,"val");break;case"gridBefore":t.gridBefore=b.intAttr(e,"val");break;case"gridAfter":t.gridAfter=b.intAttr(e,"val");break;default:return!1}return!0})}parseTableCell(e){var t={type:d.Cell,children:[]};return D.foreach(e,e=>{switch(e.localName){case"tbl":t.children.push(this.parseTable(e));break;case"p":t.children.push(this.parseParagraph(e));break;case"tcPr":this.parseTableCellProperties(e,t)}}),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"gridSpan":t.span=b.intAttr(e,"val",null);break;case"vMerge":t.verticalMerge=b.attr(e,"val")??"continue";break;case"cnfStyle":t.className=B.classNameOfCnfStyle(e);break;default:return!1}return!0}),this.parseTableCellVerticalText(e,t)}parseTableCellVerticalText(e,t){let r={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};D.foreach(e,e=>{"textDirection"===e.localName&&(e=b.attr(e,"val"),e=r[e]||{writingMode:"horizontal-tb"},t.cssStyle["writing-mode"]=e.writingMode,t.cssStyle.transform=e.transform)})}parseDefaultProperties(t,r=null,a=null,s=null){return r=r||{},D.foreach(t,e=>{if(!s?.(e))switch(e.localName){case"jc":r["text-align"]=B.valueOfJc(e);break;case"textAlignment":r["vertical-align"]=B.valueOfTextAlignment(e);break;case"color":r.color=D.colorAttr(e,"val",null,ye);break;case"sz":r["font-size"]=r["min-height"]=b.lengthAttr(e,"val",p.FontSize);break;case"shd":r["background-color"]=D.colorAttr(e,"fill",null,fe);break;case"highlight":r["background-color"]=D.colorAttr(e,"val",null,ve);break;case"vertAlign":break;case"position":r.verticalAlign=b.lengthAttr(e,"val",p.FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":r.width=B.valueOfSize(e,"w");break;case"trHeight":this.parseTrHeight(e,r);break;case"strike":r["text-decoration"]=b.boolAttr(e,"val",!0)?"line-through":"none";break;case"b":r["font-weight"]=b.boolAttr(e,"val",!0)?"bold":"normal";break;case"i":r["font-style"]=b.boolAttr(e,"val",!0)?"italic":"normal";break;case"caps":r["text-transform"]=b.boolAttr(e,"val",!0)?"uppercase":"none";break;case"smallCaps":r["font-variant"]=b.boolAttr(e,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(e,r);break;case"ind":case"tblInd":this.parseIndentation(e,r);break;case"rFonts":this.parseFont(e,r);break;case"tblBorders":this.parseBorderProperties(e,a||r);break;case"tblCellSpacing":r["border-spacing"]=B.valueOfMargin(e),r["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(e,r);break;case"bdr":r.border=B.valueOfBorder(e);break;case"tcBorders":this.parseBorderProperties(e,r);break;case"vanish":b.boolAttr(e,"val",!0)&&(r.display="none");break;case"kern":case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(e,a||r);break;case"tblLayout":r["table-layout"]=B.valueOfTblLayout(e);break;case"vAlign":r["vertical-align"]=B.valueOfTextAlignment(e);break;case"spacing":"pPr"==t.localName&&this.parseSpacing(e,r);break;case"wordWrap":b.boolAttr(e,"val")&&(r["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":r.hyphens=b.boolAttr(e,"val",!0)?"none":"auto";break;case"lang":r.$lang=b.attr(e,"val");break;case"rtl":case"bidi":b.boolAttr(e,"val",!0)&&(r.direction="rtl");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${t.localName}.`+e.localName)}}),r}parseUnderline(e,t){var r=b.attr(e,"val");if(null!=r){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"words":t["text-decoration"]="underline";break;case"none":t["text-decoration"]="none"}r=D.colorAttr(e,"color");r&&(t["text-decoration-color"]=r)}}parseFont(e,t){e=[b.attr(e,"ascii"),B.themeValue(e,"asciiTheme"),b.attr(e,"eastAsia")].filter(e=>e).map(e=>s(e));0<e.length&&(t["font-family"]=[...new Set(e)].join(", "))}parseIndentation(e,t){var r=b.lengthAttr(e,"firstLine"),a=b.lengthAttr(e,"hanging"),s=b.lengthAttr(e,"left"),n=b.lengthAttr(e,"start"),l=b.lengthAttr(e,"right"),e=b.lengthAttr(e,"end");r&&(t["text-indent"]=r),a&&(t["text-indent"]="-"+a),(s||n)&&(t["margin-inline-start"]=s||n),(l||e)&&(t["margin-inline-end"]=l||e)}parseSpacing(e,t){var r=b.lengthAttr(e,"before"),a=b.lengthAttr(e,"after"),s=b.intAttr(e,"line",null),e=b.attr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),null!==s)switch(e){case"auto":t["line-height"]=""+(s/240).toFixed(2);break;case"atLeast":t["line-height"]=`calc(100% + ${s/20}pt)`;break;default:t["line-height"]=t["min-height"]=s/20+"pt"}}parseMarginProperties(e,t){D.foreach(e,e=>{switch(e.localName){case"left":t["padding-left"]=B.valueOfMargin(e);break;case"right":t["padding-right"]=B.valueOfMargin(e);break;case"top":t["padding-top"]=B.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=B.valueOfMargin(e)}})}parseTrHeight(e,t){b.attr(e,"hRule"),t.height=b.lengthAttr(e,"val")}parseBorderProperties(e,t){D.foreach(e,e=>{switch(e.localName){case"start":case"left":t["border-left"]=B.valueOfBorder(e);break;case"end":case"right":t["border-right"]=B.valueOfBorder(e);break;case"top":t["border-top"]=B.valueOfBorder(e);break;case"bottom":t["border-bottom"]=B.valueOfBorder(e)}})}}let Ce=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class D{static foreach(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];a.nodeType==Node.ELEMENT_NODE&&t(a)}}static colorAttr(e,t,r=null,a="black"){t=b.attr(e,t);return t?"auto"==t?a:Ce.includes(t)?t:"#"+t:(a=b.attr(e,"themeColor"))?`var(--docx-${a}-color)`:r}static sizeValue(e,t=p.Dxa){return u(e.textContent,t)}}class B{static themeValue(e,t){e=b.attr(e,t);return e?`var(--docx-${e}-font)`:null}static valueOfSize(e,t){var r=p.Dxa;switch(b.attr(e,"type")){case"dxa":break;case"pct":r=p.Percent;break;case"auto":return"auto"}return b.lengthAttr(e,t,r)}static valueOfMargin(e){return b.lengthAttr(e,"w")}static valueOfBorder(e){var t,r=B.parseBorderType(b.attr(e,"val"));return"none"==r?"none":(t=D.colorAttr(e,"color"),b.lengthAttr(e,"sz",p.Border)+` ${r} `+("auto"==t?ke:t))}static parseBorderType(e){switch(e){case"single":case"dashDotStroked":return"solid";case"dashed":case"dashSmallGap":return"dashed";case"dotDash":case"dotDotDash":case"dotted":return"dotted";case"double":case"doubleWave":return"double";case"inset":return"inset";case"nil":case"none":return"none";case"outset":return"outset";case"thick":case"thickThinLargeGap":case"thickThinMediumGap":case"thickThinSmallGap":case"thinThickLargeGap":case"thinThickMediumGap":case"thinThickSmallGap":case"thinThickThinLargeGap":case"thinThickThinMediumGap":case"thinThickThinSmallGap":case"threeDEmboss":case"threeDEngrave":return"solid";case"triple":return"double";case"wave":return"solid"}return"solid"}static valueOfTblLayout(e){return"fixed"==b.attr(e,"val")?"fixed":"auto"}static classNameOfCnfStyle(e){let r=b.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((e,t)=>"1"==r[t]).join(" ")}static valueOfJc(e){e=b.attr(e,"val");switch(e){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return e}static valueOfVertAlign(e,t=!1){e=b.attr(e,"val");switch(e){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:e}static valueOfTextAlignment(e){e=b.attr(e,"val");switch(e){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return e}static addSize(e,t){return null==e?t:null==t?e:`calc(${e} + ${t})`}static classNameOftblLook(e){var t=b.hexAttr(e,"val",0);let r="";return(b.boolAttr(e,"firstRow")||32&t)&&(r+=" first-row"),(b.boolAttr(e,"lastRow")||64&t)&&(r+=" last-row"),(b.boolAttr(e,"firstColumn")||128&t)&&(r+=" first-col"),(b.boolAttr(e,"lastColumn")||256&t)&&(r+=" last-col"),(b.boolAttr(e,"noHBand")||512&t)&&(r+=" no-hband"),(b.boolAttr(e,"noVBand")||1024&t)&&(r+=" no-vband"),r.trim()}}let xe={pos:0,leader:"none",style:"left"};function Me(e){return parseFloat(e)}let L={svg:"http://www.w3.org/2000/svg",mathML:"http://www.w3.org/1998/Math/MathML"};class Ne{constructor(e){this.htmlDocument=e,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHeaderFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}async render(e,t,r=null,a){this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),Ee(r=r||t),Ee(t),r.appendChild(this.createComment("docxjs library predefined styles")),r.appendChild(this.renderDefaultStyle()),e.themePart&&(r.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(e.themePart,r)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),r.appendChild(this.createComment("docxjs document styles")),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.prodessNumberings(e.numberingPart.domNumberings),r.appendChild(this.createComment("docxjs document numbering styles")),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),e.footnotesPart&&(this.footnoteMap=c(e.footnotesPart.notes,e=>e.id)),e.endnotesPart&&(this.endnoteMap=c(e.endnotesPart.notes,e=>e.id)),e.settingsPart&&(this.defaultTabSize=e.settingsPart.settings?.defaultTabStop),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r);r=t;this.options.inWrapper&&(r=this.renderWrapper(),t.appendChild(r)),this.renderSections(e.documentPart.body,r),this.commentHighlight&&a.renderComments&&CSS.highlights.set(this.className+"-comments",this.commentHighlight),this.postRenderTasks.forEach(e=>e()),await Promise.allSettled(this.tasks),this.refreshTabStops()}renderTheme(e,t){var r={},a=e.theme?.fontScheme,a=(a&&(a.majorFont&&(r["--docx-majorHAnsi-font"]=a.majorFont.latinTypeface),a.minorFont)&&(r["--docx-minorHAnsi-font"]=a.minorFont.latinTypeface),e.theme?.colorScheme);if(a)for(var[s,n]of Object.entries(a.colors))r[`--docx-${s}-color`]="#"+n;e=this.styleToString("."+this.className,r);t.appendChild(this.createStyleElement(e))}renderFontTable(e,a){for(let r of e.fonts)for(let t of r.embedFontRefs)this.tasks.push(this.document.loadFont(t.id,t.key).then(e=>{e={"font-family":s(r.name),src:`url(${e})`},"bold"!=t.type&&"boldItalic"!=t.type||(e["font-weight"]="bold"),"italic"!=t.type&&"boldItalic"!=t.type||(e["font-style"]="italic"),e=this.styleToString("@font-face",e);a.appendChild(this.createComment(`docxjs ${r.name} font`)),a.appendChild(this.createStyleElement(e))}))}processStyleName(e){return e?this.className+"_"+e?.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase():this.className}processStyles(e){var r,t,a=c(e.filter(e=>null!=e.id),e=>e.id);for(r of e.filter(e=>e.basedOn)){var s=a[r.basedOn];if(s){r.paragraphProps=o(r.paragraphProps,s.paragraphProps),r.runProps=o(r.runProps,s.runProps);for(let t of s.styles){var n=r.styles.find(e=>e.target==t.target);n?this.copyStyleProperties(t.values,n.values):r.styles.push({...t,values:{...t.values}})}}else this.options.debug&&console.warn("Can't find base style "+r.basedOn)}for(t of e)t.cssName=this.processStyleName(t.id);return a}prodessNumberings(e){for(var t of e.filter(e=>e.pStyleName)){var r=this.findStyle(t.pStyleName);r?.paragraphProps?.numbering&&(r.paragraphProps.numbering.level=t.level)}}processElement(e){if(e.children)for(var t of e.children)t.parent=e,t.type==d.Table?this.processTable(t):this.processElement(t)}processTable(e){for(var t of e.children)for(var r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}copyStyleProperties(e,t,r=null){if(e){null==t&&(t={});for(var a of r=null==r?Object.getOwnPropertyNames(e):r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a])}return t}createPageElement(e,t){e=this.createElement("section",{className:e});return t&&(t.pageMargins&&(e.style.paddingLeft=t.pageMargins.left,e.style.paddingRight=t.pageMargins.right,e.style.paddingTop=t.pageMargins.top,e.style.paddingBottom=t.pageMargins.bottom),t.pageSize)&&(this.options.ignoreWidth||(e.style.width=t.pageSize.width),this.options.ignoreHeight||(e.style.minHeight=t.pageSize.height)),e}createSectionContent(e){var t=this.createElement("article");return e&&e.columns&&e.columns.numberOfColumns&&(t.style.columnCount=""+e.columns.numberOfColumns,t.style.columnGap=e.columns.space,e.columns.separator)&&(t.style.columnRule="1px solid black"),t}renderSections(r,a){this.processElement(r);var s=this.splitByPage(r.children);let n=null;for(let e=0,t=s.length;e<t;e++){this.currentFootnoteIds=[];var l=s[e],i=l.sectProps||r.props,o=this.createPageElement(this.className,i),c=(a.appendChild(o),this.renderStyleValues(r.cssStyle,o),this.options.renderHeaders&&this.renderHeaderFooter(i.headerRefs,i,e,n!=i,o),this.createSectionContent(l.sectProps));o.appendChild(c),this.renderElements(l.elements,c),this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,o),this.options.renderEndnotes&&e==t-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,o),this.options.renderFooters&&this.renderHeaderFooter(i.footerRefs,i,e,n!=i,o),n=i}}renderHeaderFooter(e,t,r,a,s){e&&(r=(a=(t.titlePage&&a?e.find(e=>"first"==e.type):null)??(r%2==1?e.find(e=>"even"==e.type):null)??e.find(e=>"default"==e.type))&&this.document.findPartByRelId(a.id,this.document.documentPart))&&(this.currentPart=r,this.usedHeaderFooterParts.includes(r.path)||(this.processElement(r.rootElement),this.usedHeaderFooterParts.push(r.path)),[e]=this.renderElements([r.rootElement],s),t?.pageMargins&&(r.rootElement.type===d.Header?(e.style.marginTop=`calc(${t.pageMargins.header} - ${t.pageMargins.top})`,e.style.minHeight=`calc(${t.pageMargins.top} - ${t.pageMargins.header})`):r.rootElement.type===d.Footer&&(e.style.marginBottom=`calc(${t.pageMargins.footer} - ${t.pageMargins.bottom})`,e.style.minHeight=`calc(${t.pageMargins.bottom} - ${t.pageMargins.footer})`)),this.currentPart=null)}isPageBreakElement(e){return e.type==d.Break&&("lastRenderedPageBreak"==e.break?this.options.useLastRenderedPageBreak:"page"==e.break)}splitByPage(e,t){var r,a,s,n,l,i,o,c,h={sectProps:null,elements:[]},m=[h];for(r of e)r.type==d.Paragraph&&this.findStyle(r.styleName)?.paragraphProps?.pageBreakBefore&&(h.sectProps=a,m.push(h={sectProps:null,elements:[]})),h.elements.push(r),r.type==d.Paragraph&&(a=(o=r).sectionProps,s=c=-1,this.options.breakPages&&o.children&&(c=o.children.findIndex(e=>-1!=(s=e.children?.findIndex(this.isPageBreakElement.bind(this))??-1))),!a&&-1==c||(h.sectProps=a,m.push(h={sectProps:null,elements:[]})),-1!=c)&&(n=o.children[c],l=s<n.children.length-1,c<o.children.length-1||l)&&(o=r.children,i={...r,children:o.slice(c)},r.children=o.slice(0,c),h.elements.push(i),l)&&(o=n.children,c={...n,children:o.slice(0,s)},r.children.push(c),n.children=o.slice(s));let p=null;for(let e=m.length-1;0<=e;e--)null==m[e].sectProps?m[e].sectProps=p??t:p=m[e].sectProps;return m}renderWrapper(e){return this.createElement("div",{className:this.className+"-wrapper"},e)}renderDefaultStyle(){var e=this.className,t=`
.${e}-wrapper {
	background: gray;
	counter-reset: ${e}-page 0;
	display: flex;
	padding: 30px;
	column-gap: 30px;
	row-gap: 30px;
	flex-flow: column;
	align-items: center;
}`,t=(t=this.options.hideWrapperOnPrint?`@media not print { ${t} }`:t)+`
.${e}-side2side .${e}-wrapper {
	flex-flow: row;
	flex-wrap: wrap;
	align-items: start;
	justify-content: center;
}
.${e}-wrapper > section.${e} {
	background: white;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
}
.${e}-pagering .${e}-wrapper > section.${e}:before {
	background: white;
	color: gray;
	counter-increment: ${e}-page 1;
	content: counter(docx-page) " ";
	font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
	font-size: 12px;
	height: 16px;
	line-height: 16px;
	padding: 0 5px;
	text-align: center;
	position: absolute;
	left: 0;
	top: -16px;
}
.${e} {
	color: black;
	hyphens: auto;
	text-underline-position: from-font;
}
section.${e} {
	box-sizing: border-box;
	display: flex;
	flex-flow: column nowrap;
	position: relative;
}
section.${e} > article {
	margin-bottom: auto;
	z-index: 1;
}
section.${e} > footer {
	z-index: 1;
}
.${e} table {
	border-collapse: collapse;
}
.${e} table td, .${e} table th {
	vertical-align: top;
}
.${e} p {
	margin: 0pt;
	min-height: 1em;
}
.${e} span {
	white-space: pre-wrap;
	overflow-wrap: break-word;
}
.${e} a {
	color: inherit;
	text-decoration: inherit;
}
`;return this.options.renderComments&&(t+=`
.${e}-comment-ref { cursor: default; }
.${e}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }
.${e}-comment-ref:hover~.${e}-comment-popover { display: block; }
.${e}-comment-author,.${e}-comment-date { font-size: 0.875rem; color: #888; }
`),this.createStyleElement(t)}renderNumbering(e,r){var a,s="",t=[this.className+"-page"];for(a of e){var n,l,i="p."+this.numberingClass(a.id,a.level),o="none";if(a.bullet){let t=(`--${this.className}-`+a.bullet.src).toLowerCase();s+=this.styleToString(i+":before",{content:"' '",display:"inline-block",background:`var(${t})`},a.bullet.style),this.tasks.push(this.document.loadNumberingImage(a.bullet.src).then(e=>{e=`${this.rootSelector} { ${t}: url(${e}) }`;r.appendChild(this.createStyleElement(e))}))}else a.levelText?(l=(n=this.numberingCounter(a.id,a.level))+" "+(a.start-1),0<a.level&&(s+=this.styleToString("p."+this.numberingClass(a.id,a.level-1),{"counter-set":l})),t.push(l),s+=this.styleToString(i+":before",{content:this.levelTextToContent(a.levelText,a.suff,a.id,this.numFormatToCssValue(a.format)),"counter-increment":n,...a.rStyle})):o=this.numFormatToCssValue(a.format);s+=this.styleToString(i,{display:"list-item","list-style-position":"inside","list-style-type":o,...a.pStyle})}return 0<t.length&&(s+=this.styleToString(this.rootSelector,{"counter-reset":t.join(" ")})),this.createStyleElement(s)}renderStyles(e){var t,r="",a=this.styleMap,s=c(e.filter(e=>e.isDefault),e=>e.target);for(t of e){var n,l,i=t.styles;t.linked&&((n=t.linked&&a[t.linked])?i=i.concat(n.styles):this.options.debug&&console.warn("Can't find linked style "+t.linked));for(l of i){var o=`${t.target??""}.`+t.cssName;t.target!=l.target&&(o+=" "+l.target),s[t.target]==t&&(o=`.${this.className} ${t.target}, `+o),r+=this.styleToString(o,l.values)}}return this.createStyleElement(r)}renderNotes(e,t,r){var e=e.map(e=>t[e]).filter(e=>e);0<e.length&&(e=this.createElement("ol",null,this.renderElements(e)),r.appendChild(e))}renderElement(e){switch(e.type){case d.Paragraph:return this.renderParagraph(e);case d.BookmarkStart:return this.renderBookmarkStart(e);case d.BookmarkEnd:return null;case d.Run:return this.renderRun(e);case d.Table:return this.renderTable(e);case d.Row:return this.renderTableRow(e);case d.Cell:return this.renderTableCell(e);case d.Hyperlink:return this.renderHyperlink(e);case d.SmartTag:return this.renderSmartTag(e);case d.Drawing:return this.renderDrawing(e);case d.Image:return this.renderImage(e);case d.Text:case d.Text:return this.renderText(e);case d.DeletedText:return this.renderDeletedText(e);case d.Tab:return this.renderTab(e);case d.Symbol:return this.renderSymbol(e);case d.Break:return this.renderBreak(e);case d.Footer:return this.renderContainer(e,"footer");case d.Header:return this.renderContainer(e,"header");case d.Footnote:case d.Endnote:return this.renderContainer(e,"li");case d.FootnoteReference:return this.renderFootnoteReference(e);case d.EndnoteReference:return this.renderEndnoteReference(e);case d.NoBreakHyphen:return this.createElement("wbr");case d.VmlPicture:return this.renderVmlPicture(e);case d.VmlElement:return this.renderVmlElement(e);case d.MmlMath:return this.renderContainerNS(e,L.mathML,"math",{xmlns:L.mathML});case d.MmlMathParagraph:return this.renderContainer(e,"span");case d.MmlFraction:return this.renderContainerNS(e,L.mathML,"mfrac");case d.MmlBase:return this.renderContainerNS(e,L.mathML,e.parent.type==d.MmlMatrixRow?"mtd":"mrow");case d.MmlNumerator:case d.MmlDenominator:case d.MmlFunction:case d.MmlLimit:case d.MmlBox:return this.renderContainerNS(e,L.mathML,"mrow");case d.MmlGroupChar:return this.renderMmlGroupChar(e);case d.MmlLimitLower:return this.renderContainerNS(e,L.mathML,"munder");case d.MmlMatrix:return this.renderContainerNS(e,L.mathML,"mtable");case d.MmlMatrixRow:return this.renderContainerNS(e,L.mathML,"mtr");case d.MmlRadical:return this.renderMmlRadical(e);case d.MmlSuperscript:return this.renderContainerNS(e,L.mathML,"msup");case d.MmlSubscript:return this.renderContainerNS(e,L.mathML,"msub");case d.MmlDegree:case d.MmlSuperArgument:case d.MmlSubArgument:return this.renderContainerNS(e,L.mathML,"mn");case d.MmlFunctionName:return this.renderContainerNS(e,L.mathML,"ms");case d.MmlDelimiter:return this.renderMmlDelimiter(e);case d.MmlRun:return this.renderMmlRun(e);case d.MmlNary:return this.renderMmlNary(e);case d.MmlPreSubSuper:return this.renderMmlPreSubSuper(e);case d.MmlBar:return this.renderMmlBar(e);case d.MmlEquationArray:return this.renderMllList(e);case d.Inserted:return this.renderInserted(e);case d.Deleted:return this.renderDeleted(e);case d.CommentRangeStart:return this.renderCommentRangeStart(e);case d.CommentRangeEnd:return this.renderCommentRangeEnd(e);case d.CommentReference:return this.renderCommentReference(e);case d.AltChunk:return this.renderAltChunk(e)}return null}renderElements(e,t){return null==e?null:(e=e.flatMap(e=>this.renderElement(e)).filter(e=>null!=e),t&&Ae(t,e),e)}renderContainer(e,t,r){return this.createElement(t,r,this.renderElements(e.children))}renderContainerNS(e,t,r,a){return this.createElementNS(t,r,a,this.renderElements(e.children))}renderParagraph(e){var t=this.renderContainer(e,"p"),r=this.findStyle(e.styleName),e=(e.tabs??(e.tabs=r?.paragraphProps?.tabs),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderCommonProperties(t.style,e),e.numbering??r?.paragraphProps?.numbering);return e&&t.classList.add(this.numberingClass(e.id,e.level)),t}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize)&&(e["font-size"]=t.fontSize)}renderHyperlink(t){var e,r=this.renderContainer(t,"a");this.renderStyleValues(t.cssStyle,r);let a="";return t.id&&(e=this.document.documentPart.rels.find(e=>e.id==t.id&&"External"===e.targetMode),a=e?.target??a),t.anchor&&(a+="#"+t.anchor),r.href=a,r}renderSmartTag(e){return this.renderContainer(e,"span")}renderCommentRangeStart(e){if(!this.options.renderComments)return null;let t=new Range,r=(this.commentHighlight?.add(t),this.htmlDocument.createComment("start of comment #"+e.id));return this.later(()=>t.setStart(r,0)),this.commentMap[e.id]=t,r}renderCommentRangeEnd(e){if(!this.options.renderComments)return null;let t=this.commentMap[e.id],r=this.htmlDocument.createComment("end of comment #"+e.id);return this.later(()=>t?.setEnd(r,0)),r}renderCommentReference(e){var t,r,a;return this.options.renderComments&&(e=this.document.commentsPart?.commentMap[e.id])?(t=new DocumentFragment,r=this.createElement("span",{className:this.className+"-comment-ref"},[""]),a=this.createElement("div",{className:this.className+"-comment-popover"}),this.renderCommentContent(e,a),t.appendChild(this.htmlDocument.createComment(`comment #${e.id} by ${e.author} on `+e.date)),t.appendChild(r),t.appendChild(a),t):null}renderAltChunk(e){var t;return this.options.renderAltChunks?(t=this.createElement("iframe"),this.tasks.push(this.document.loadAltChunk(e.id,this.currentPart).then(e=>{t.srcdoc=e})),t):null}renderCommentContent(e,t){t.appendChild(this.createElement("div",{className:this.className+"-comment-author"},[e.author])),t.appendChild(this.createElement("div",{className:this.className+"-comment-date"},[new Date(e.date).toLocaleString()])),this.renderElements(e.children,t)}renderDrawing(e){var t=this.renderContainer(e,"div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=this.createElement("img");return this.renderStyleValues(e.cssStyle,t),this.document&&this.tasks.push(this.document.loadDocumentImage(e.src,this.currentPart).then(e=>{t.src=e})),t}renderText(e){return this.htmlDocument.createTextNode(e.text)}renderDeletedText(e){return this.options.renderEndnotes?this.htmlDocument.createTextNode(e.text):null}renderBreak(e){return"textWrapping"==e.break?this.createElement("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderElements(e.children)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){var t=this.createElement("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderFootnoteReference(e){var t=this.createElement("sup");return this.currentFootnoteIds.push(e.id),t.textContent=""+this.currentFootnoteIds.length,t}renderEndnoteReference(e){var t=this.createElement("sup");return this.currentEndnoteIds.push(e.id),t.textContent=""+this.currentEndnoteIds.length,t}renderTab(e){var t=this.createElement("span");return t.innerHTML="&emsp;",this.options.experimental&&(t.className=this.tabStopClass(),e=((e,t)=>{for(var r=e.parent;null!=r&&r.type!=t;)r=r.parent;return r})(e,d.Paragraph)?.tabs,this.currentTabs.push({stops:e,span:t})),t}renderBookmarkStart(e){return this.createElement("span",{id:e.name})}renderRun(e){var t,r;return e.fieldRun?null:(t=this.createElement("span"),e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign?(r=this.createElement(e.verticalAlign),this.renderElements(e.children,r),t.appendChild(r)):this.renderElements(e.children,t),t)}renderTable(e){var t=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){var t,r=this.createElement("colgroup");for(t of e){var a=this.createElement("col");t.width&&(a.style.width=t.width),r.appendChild(a)}return r}renderTableRow(e){var t=this.createElement("tr");return this.currentCellPosition.col=0,e.gridBefore&&t.appendChild(this.renderTableCellPlaceholder(e.gridBefore)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),e.gridAfter&&t.appendChild(this.renderTableCellPlaceholder(e.gridAfter)),this.currentCellPosition.row++,t}renderTableCellPlaceholder(e){e=this.createElement("td",{colSpan:e});return e.style.border="none",e}renderTableCell(e){var t=this.renderContainer(e,"td"),r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t).rowSpan=1:this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){return this.renderContainer(e,"div")}renderVmlElement(e){var t=this.createSvgElement("svg");t.setAttribute("style",e.cssStyleText);let r=this.renderVmlChildElement(e);return e.imageHref?.id&&this.tasks.push(this.document?.loadDocumentImage(e.imageHref.id,this.currentPart).then(e=>r.setAttribute("href",e))),t.appendChild(r),requestAnimationFrame(()=>{var e=t.firstElementChild.getBBox();t.setAttribute("width",""+Math.ceil(e.x+e.width)),t.setAttribute("height",""+Math.ceil(e.y+e.height))}),t}renderVmlChildElement(e){let r=this.createSvgElement(e.tagName);Object.entries(e.attrs).forEach(([e,t])=>r.setAttribute(e,t));for(var t of e.children)t.type==d.VmlElement?r.appendChild(this.renderVmlChildElement(t)):r.appendChild(...h(this.renderElement(t)));return r}renderMmlRadical(e){var t=e.children.find(e=>e.type==d.MmlBase);return e.props?.hideDegree?this.createElementNS(L.mathML,"msqrt",null,this.renderElements([t])):(e=e.children.find(e=>e.type==d.MmlDegree),this.createElementNS(L.mathML,"mroot",null,this.renderElements([t,e])))}renderMmlDelimiter(e){var t=[];return t.push(this.createElementNS(L.mathML,"mo",null,[e.props.beginChar??"("])),t.push(...this.renderElements(e.children)),t.push(this.createElementNS(L.mathML,"mo",null,[e.props.endChar??")"])),this.createElementNS(L.mathML,"mrow",null,t)}renderMmlNary(e){var t=[],r=c(e.children,e=>e.type),a=r[d.MmlSuperArgument],s=r[d.MmlSubArgument],a=a?this.createElementNS(L.mathML,"mo",null,h(this.renderElement(a))):null,s=s?this.createElementNS(L.mathML,"mo",null,h(this.renderElement(s))):null,e=this.createElementNS(L.mathML,"mo",null,[e.props?.char??""]);return t.push(a||s?this.createElementNS(L.mathML,"munderover",null,[e,s,a]):a?this.createElementNS(L.mathML,"mover",null,[e,a]):s?this.createElementNS(L.mathML,"munder",null,[e,s]):e),t.push(...this.renderElements(r[d.MmlBase].children)),this.createElementNS(L.mathML,"mrow",null,t)}renderMmlPreSubSuper(e){var t=[],e=c(e.children,e=>e.type),r=e[d.MmlSuperArgument],a=e[d.MmlSubArgument],r=r?this.createElementNS(L.mathML,"mo",null,h(this.renderElement(r))):null,a=a?this.createElementNS(L.mathML,"mo",null,h(this.renderElement(a))):null,s=this.createElementNS(L.mathML,"mo",null);return t.push(this.createElementNS(L.mathML,"msubsup",null,[s,a,r])),t.push(...this.renderElements(e[d.MmlBase].children)),this.createElementNS(L.mathML,"mrow",null,t)}renderMmlGroupChar(e){var t="bot"===e.props.verticalJustification?"mover":"munder",t=this.renderContainerNS(e,L.mathML,t);return e.props.char&&t.appendChild(this.createElementNS(L.mathML,"mo",null,[e.props.char])),t}renderMmlBar(e){var t=this.renderContainerNS(e,L.mathML,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}renderMmlRun(e){var t=this.createElementNS(L.mathML,"ms",null,this.renderElements(e.children));return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),t}renderMllList(e){var t,r=this.createElementNS(L.mathML,"mtable");this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r);for(t of this.renderElements(e.children))r.appendChild(this.createElementNS(L.mathML,"mtr",null,[this.createElementNS(L.mathML,"mtd",null,[t])]));return r}renderStyleValues(e,t){for(var r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){return e&&this.styleMap?.[e]}numberingClass(e,t){return this.className+`-num-${e}-`+t}tabStopClass(){return this.className+"-tab-stop"}styleToString(e,t,r=null){let a=e+` {\r
`;for(var s in t)s.startsWith("$")||(a+=`  ${s}: ${t[s]};\r
`);return r&&(a+=r),a+"}\r\n"}numberingCounter(e,t){return this.className+`-num-${e}-`+t}levelTextToContent(e,t,r,a){return`"${e.replace(/%\d*/g,e=>{e=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,e)}, ${a})"`})}${{tab:"\\9",space:"\\a0"}[t]??""}"`}numFormatToCssValue(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e]??e}refreshTabStops(){this.options.experimental&&setTimeout(()=>{e=document.body,(t=document.createElement("div")).style.width="100pt",e.appendChild(t),r=100/t.offsetWidth,e.removeChild(t);var e,t,r,a,s=r;for(a of this.currentTabs)((r,a,s,n)=>{var l=r.closest("p"),i=r.getBoundingClientRect(),o=l.getBoundingClientRect(),c=getComputedStyle(l);let e=0<a?.length?a.map(e=>({pos:Me(e.position),leader:e.leader,style:e.style})).sort((e,t)=>e.pos-t.pos):[xe];var a=e[e.length-1],t=o.width*n,h=Me(s);let m=a.pos+h;if(m<t)for(;m<t&&e.length<50;m+=h)e.push({...xe,pos:m});s=parseFloat(c.marginLeft),a=o.left+s;let p=(i.left-a)*n;if(null!=(c=e.find(e=>"clear"!=e.style&&e.pos>p))){let t=1;if("right"==c.style||"center"==c.style){let e=Array.from(l.querySelectorAll("."+r.className));i=e.indexOf(r)+1,a=document.createRange(),i=(a.setStart(r,1),i<e.length?a.setEndBefore(e[i]):a.setEndAfter(l),"center"==c.style?.5:1),l=a.getBoundingClientRect(),a=l.left+i*l.width-(o.left-s);t=c.pos-a*n}else t=c.pos-p;switch(r.innerHTML="&nbsp;",r.style.textDecoration="inherit",r.style.wordSpacing=t.toFixed(0)+"pt",c.leader){case"dot":case"middleDot":r.style.textDecoration="underline",r.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":r.style.textDecoration="underline"}}})(a.span,a.stops,this.defaultTabSize,s)},500)}createElementNS(e,t,r,a){e=e?this.htmlDocument.createElementNS(e,t):this.htmlDocument.createElement(t);return Object.assign(e,r),a&&Ae(e,a),e}createElement(e,t,r){return this.createElementNS(void 0,e,t,r)}createSvgElement(e,t,r){return this.createElementNS(L.svg,e,t,r)}createStyleElement(e){return this.createElement("style",{innerHTML:e})}createComment(e){return this.htmlDocument.createComment(e)}later(e){this.postRenderTasks.push(e)}}function Ee(e){e.innerHTML=""}function Ae(r,e){e.forEach(e=>{return r.appendChild("string"==typeof(t=e)||t instanceof String?document.createTextNode(e):e);var t})}let F={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,hideWrapperOnPrint:!1,trimXmlDeclaration:!0,useLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1,renderAltChunks:!0};function Te(e,t){t={...F,...t};return ce.load(e,new Pe(t),t)}async function Re(e,t,r,a){a={...F,...a};return new Ne(window.document).render(e,t,r,a)}e.defaultOptions=F,e.parseAsync=Te,e.renderAsync=async function(e,t,r,a){return await Re(e=await Te(e,a),t,r,a),e},e.renderDocument=Re});
//# sourceMappingURL=docx-preview.min.js.map